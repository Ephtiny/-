# 1. 引论

## 1.1 集成电路简史

晶体管(Transistor)发展历程：点接触式晶体管 -> 双极型晶体管 -> 半导体场效应管(MOSFET)

晶体管：

- 一个电阻或半导体器件，当电信号从它的输入端通过它传输到输出端时会被放大
- 可以看成一个电控开关，有一个控制端和另外两个端口，取决于加在控制端上的电压或电流，这两个端口将连通或断开。1

双极型晶体管：

- 需要将一个小电流输入到控制端（基极）以通断另外两个端口（发射极和集电极）之间大得多的电流
- 基极电流在电路不翻转时仍然存在，由它们引起的静态功耗限制了最多能集成在单个管芯上的晶体管数目
- 相对较可靠、噪声低，且功率效率高

半导体场效应(MOSFET)：

- 有两种类型：nMOS和pMOS，分别采用n型硅和p型硅
- 闲置状态下的控制电流几乎为零



互补金属氧化物半导体，即CMOS：首批MOSFET逻辑门，同时采用nMOS和pMOS晶体管。电路采用分离器件晶体管，但功耗只有几纳瓦，相对双极型电路，功耗减低了六个数量级



摩尔定律：单芯片上的晶体管数目没18个月就会翻一倍

尺寸缩小定律：晶体管尺寸缩小时，它们将变得更快，功耗更小，且制造成本更低



芯片的集成度分为小规模、中规模、大规模和超大规模

- 小规模集成(Small-Scale Integration, SSI)电路如7404反相器，含10个以下的逻辑门，每个门大约由6个晶体管组成
- 中规模集成(Medium-Scale Integration, MSI)电路如74161计数器，含多至1000个门
- 大规模集成(Large-Scale Integration, LSI)电路如简单的8位微处理器，含至多10 000个门
- 超大规模(Very Large-Scale Integration, VLSI)电路用于描述自20世纪80年代以来的大多数集成电路



​	虽然单个CMOS晶体管每次开关时只需消耗很少的能量，但巨大数目的晶体管以非常高的速率开关时所产生的功耗再次称为设计的主要考虑因素。而且当晶体管的尺寸变得很小时，它们就不能完全关断。因而虽然经过每个晶体管的泄露电流很小，但当一块芯片上有上亿个晶体管时将会导致非常大的功耗



CMOS制造工艺的特征尺寸：可靠生产处的晶体管的最小尺寸

​	制造商每两三年就开发处特征尺寸再缩小30%的新一代工艺（也称为工艺节点），使再相同的芯片面积上能集成多两倍数目的晶体管

​	微米工艺中较不显著的效应，如晶体管的泄露电流、相邻晶体管之间的特性扰动以及导线电阻等在纳米工艺中将变得非常显著

​	每个晶体管的光刻成本在下降，但一次就能成功的设计成本却一直呈指数规律增长



## 1.2 概述

​	随着单芯片上晶体管数目的急剧增长，设计者已开始依靠不断提高自动化水平来寻求获取相应的生产效率。许多设计者把他们的主要精力放在用硬件描述语言描述功能而很少去注意实际的晶体管。但芯片设计不是软件工程。解决较困难的问题需要对电路和物理设计有基本的理解

​	学习VLSI设计的最好方法就是亲自实践，`www.cmosvlsi.com`网站上提供了一组实验训练以指导你设计自己的微处理芯片



## 1.3 MOS晶体管

​	硅是大多数集成电路的基础原材料。纯净的硅由三维的原子晶格(lattice)组成。纯净的硅是一种不良导体，但它的导电性可以通过在硅晶格中引入称为掺杂剂(dopant)的少量杂质来提高

​	砷(As)掺杂（V族元素）,室温下的晶格热振动可以使砷的第五个价电子自由运动，形成一个带整点的As^+^离子和一个自由电子，该自由电子可以携带电流，从而提高了材料的导电性。这类半导体的自由载流子是==带负电荷的电子==，所以称之为==n型半导体==

​	硼(B)掺杂（III族元素），它可以从相邻的硅原子中借一个电子，使这个硅原子因此缺少一个电子，而这个硅原子又向相邻的硅原子借电子，以此类推会出现”空穴“在晶格中传播。空穴的作用像一个==带正电荷的载流子==，所以称这类半导体为==p型半导体==



二极管：p型和n型硅之间形成的结

- 当作阳极的p型半导体上的电压高于作阴极的n型半导体时，二极管正向偏置，有电流流过。反之则反向偏置，几乎无电流

 金属-氧化物-半导体(MOS)结构是通过把几层到点和绝缘材料叠在一起形成类似三明治的结构而构成的

CMOS工艺提供两种类型的晶体管，它们也称为器件(device)：n型晶体管(nMOS)和p型晶体管(pMOS)

![image-20230421213617184](https://gitee.com/ephtiny/image/raw/master/img/202304212136891.png)

图1.9中n^+^和p^+^区域表好中掺杂的n型或p型硅

​	晶体管的工作是由电场控制的，所以这些器件又称为金属氧化物半导体场效应晶体管(MOSFET)

​	每个晶体管由一层导电栅(gate)、一层二氧化硅绝缘层以及一层硅基底（也称衬底、体、体硅）堆叠构成，这一叠层结构杯称为金属-氧化物-半导体或MOS（早起栅由金属形成，现在用多晶硅）。

​	在同时有这两种类型晶体管的CMOS工艺中，衬底可以使n型的，也可以是p型的，但类型与衬底上晶体管不同的另一种晶体管必须构造在专门的阱(well)中，阱中加入了掺杂院子以形成相反类型的衬底

​	源和漏是完全一样的，可以互换。栅是一个控制输入：它影响电流在源和漏之间的流动

- 对于nMOS管。其衬底一般接地，而源和漏雨衬底之间的p-n结都是反向偏置的。如果栅也接地，那么不会有电流流过反偏结，于是称此时晶体管关断。如果提高栅电压，会建立一个电场将自由电子吸引到Si-SiO~2~的界面下，栅压足够高时电子数目将超过空穴，栅下方称为”沟道“(channel)的一层区域将反型称为n型半导体，源和漏之间形成通路，此时晶体管导通
- 对于pMOS管则相反。其衬底保持在正电压。pMOS管的行为与nMOS管相反，其符号在栅极上有个小圆圈，就如逻辑门中反相器符号图上的小圆圈

![image-20230421220529532](https://gitee.com/ephtiny/image/raw/master/img/202304212205607.png)

图1.10中g、s和d分别表示栅、源和漏



## 1.4 CMOS逻辑

### 1.4.1 反相器

![image-20230421220707493](https://gitee.com/ephtiny/image/raw/master/img/202304212207572.png)

CMOS反相器（即非(NOT)门）由一个nMOS管和一个pMOS管构成。当输入A为0时，n关断而p导通，Y连至V~DD~，即输出Y为1。

![image-20230421221117543](https://gitee.com/ephtiny/image/raw/master/img/202304212211615.png)



### 1.4.2 与非(NAND)门

![image-20230421221305213](https://gitee.com/ephtiny/image/raw/master/img/202304212213289.png)

![image-20230421221834043](https://gitee.com/ephtiny/image/raw/master/img/202304212218140.png)

k输入的与非门由k个串联的nMOS管和k个并联的pMOS管构成，只有三个输入均为1时，输出才会通过串联的nMOS管下拉至低电平



### 1.4.3 CMOS逻辑门

​	反相器和与非门是静态CMOS逻辑门(static CMOS logic gate)也称互补CMOS门(complementary CMOS gate)的两个例子

![image-20230421222847334](https://gitee.com/ephtiny/image/raw/master/img/202304212228412.png)

​	静态CMOS门中的这两个网络被设计成对于任何一种输入图案，其中必有一个网络导通，而另一个关断。当没有这个设计时会有如下的输出状态表

![image-20230421224126489](https://gitee.com/ephtiny/image/raw/master/img/202304212241561.png)

- Z：当上拉和下拉都关断时会形成高阻(high impedance)，即浮空(floating)的输出状态Z。这在多路开关、存储单元及三态总线驱动器中很有意义
- X：当上拉而和下拉同事导通时就形成竞争(contention)电平，急用叉号(crowbar)表示的电平X。此时这连个网络之间的竞争将产生一个不确定的输出电平并引起静态功耗，这是我们不希望出现的情况



​	反相器中的上拉和下拉网络每个都只含一个晶体管，与非门采用一个晶体管串联的下拉网络和一个晶体管斌两的上拉网络

​	两个或多个晶体管的串联组合只有当所有串联的晶体管都导通时才导通，两个或多个晶体管的并联组合只要其中任何一个并联的晶体管导通就能导通。下面是一对nMOS管和pMOS管串并联时的情形，利用这些结构的组合可以构造出许多种CMOS组合门

![image-20230421223907720](https://gitee.com/ephtiny/image/raw/master/img/202304212239812.png)



### 1.4.4 或非(NOR)门

![image-20230421224644605](https://gitee.com/ephtiny/image/raw/master/img/202304212246691.png)

​	对于三输入或非门，当任何一个输入为高时，输出通过并联的nMOS管下拉至低电平。当所有输入为低时，输出通过串联的pMOS管上拉至高电平



### 1.4.5 复合门(compound gate)

![image-20230421225543323](https://gitee.com/ephtiny/image/raw/master/img/202304212255417.png)



​	实现一对二输入“与”的“或非”功能 常被称为与-或-非-22或AOI22。

​	图1.18中的a、b相对容易理解，“与”的表达式可以通过串联实现。接下来将“或”拆分为两部分，一个为a中两组一组导通则下拉，因此a中两组并联且置于下方，也就是nMOS下拉网络

​	对于pMOS上拉网络，我们必须计算与nMOS网络互补的表达式，它所采用的开关管在极性相反的输入时导通。根据德摩根定理，这相当于将一个网络中的“与”（“或”）操作与另一个网络中的“或”（“与”）操作互换。因此与下拉网络中串联nMOS管相对应的上拉网络中的pMOS管必须并联，而与下拉网络中并联nMOS管相对应的上拉网络中的pMOS管必须串联。

​	上面是书本原话，下面是我对这个的理解（这里的理解可能会存在问题，如果能看懂原文的意思那下面就不用看了）：

- 对表达式与图的分析：由于b是下拉网络，则d是上拉网络。通过表达式可知，需要(A·B)与(C·D)都要为0才能上拉（pMOS管是输入为0时导通），即A与B、C与D这两组都至少有一个是0，AB并联可以实现AB间有一个0就可导通，CD并联一样，之后二者串联
- 对原文的理解：根据我的观察，我发现nMOS负责下拉，pMOS负责上拉。对于pMOS上拉网络，计算nMOS网络互补的表达式则下拉网络中串联的变并联，并联的变串联。pMOS上拉网络所采用的开关管在极性相反的输入时导通，这里的极性相反应该不是指输入的数值相反，而应该是最终效果相反。

​	

​	当使$$C=\overline{A}$$并作为选择信号时，这个AOI22门可以用来作为一个二输入的反相多路开关，即若C=0时，Y=$$\overline{B}$$，而C为1时，Y=$$\overline{D}$$



![image-20230421235645374](https://gitee.com/ephtiny/image/raw/master/img/202304212356445.png)

​		图1.19为 或-与-非-3-1（即OAI31）门。当D为1且ABC中任何一个为1时，nMOS下拉网络将时输出下拉为低电平，所以D和A、B及C的并联组合串联在一起。由于pMOS上拉网络是nMOS下拉网络的“互补导通”，所以在pMOS上拉网络中D必须和A、B及C的串联组合并联



### 1.4.6 传输管(Pass Transistor)和传输门(Transmission Gate)

​	一个信号的强度(strength)是以它与理想电压源的接近程度来度量的。一般来说，信号越强它所能提供或吸收的电流就越多。	

​	电源电压V~DD~和GND各为最强的1和0信号源，又称轨线(rail)电压

![image-20230422151015984](https://gitee.com/ephtiny/image/raw/master/img/202304221510065.png)

​	nMOS管在传送0时是一个近乎理想的开关，因此说能传送“强0”；而传送1时不理想，得到的高电压比V~DD~要低些。pMOS管则相反。输入驱动下拉网络中nMOS只需传送0，而互补上拉网络中pMOS只需传送1，输出总是被强驱动，因而输出电平永远不会变弱，这样的门被称为“全复原”(full restored)逻辑门，能大大简化电路设计

![image-20230422151810719](https://gitee.com/ephtiny/image/raw/master/img/202304221518822.png)

- 传输管：nMOS或pMOS单独作用作为一个非理想开关
- 传输门/传送门：将nMOS与pMOS并联、

​	在图1.21(c)中，无论0还是1都能被这个开关以一种可以接受的方式传送出去

​	静态CMOS门总能正确工作而与晶体管的实际尺寸无关，且对于任何输入组合，“1”和“0”之间不会有通过晶体管使它们直接导通的路径，这也是CMOS中静态功耗很低的主要原因

​	不能直接将反相器的上下拉管互换来构成非反相门，这样会产生减弱的输出

![image-20230422153408295](https://gitee.com/ephtiny/image/raw/master/img/202304221534406.png)

​	复合门也可以也可以用两个与门、一个或门和一个反相器构成，而与门和或门又可以用与非/或非门及反相器构成，但这里总共需要20个晶体管

![image-20230422153637483](https://gitee.com/ephtiny/image/raw/master/img/202304221536559.png)

### 1.4.7 三态门

![image-20230422153821179](https://gitee.com/ephtiny/image/raw/master/img/202304221538250.png)

​	当EN为1时，三态缓冲器的作用就像一个普通的缓冲器

​	图1.26的传输门与图1.25的三态缓冲期真值表相同

![image-20230422154228860](https://gitee.com/ephtiny/image/raw/master/img/202304221542929.png)

​	EN为0时，输出浮空；EN为1时可当作反相器

​	d是三态反相器的符号。一个普通反相器之后接一个三态反相器可以构成一个三态缓冲器

​	三态总线会存在一些问题，现在设计者优先采用多路开关

### 1.4.8 多路开关(Multiplexer)

![image-20230422172108206](https://gitee.com/ephtiny/image/raw/master/img/202304222044517.png)

逻辑函数：Y = $$\overline{S}$$ · D0 + S · D1

![image-20230422173234312](https://gitee.com/ephtiny/image/raw/master/img/202304222044524.png)

​	我们可用逻辑门构成复原的反相多路开关。。一种方式是将图1.18(e)中的复合门连成如图1.29(a)那样;另一种方式是将两个三态反相器连接起来，如图1.29(b)所示。这两种方式构成的电路图儿平完全相同，只是重新排布了一下（因为它的选择信号及其反信号是相互排斥的）

​	三态反相器的方式稍微简单一些并且速度也较快些，因为它需要的内部连线较少。如果反相选择信号时在单元内部产生，那么可以把它从符号图中略去

​	较大的多路开关可以用多个二输人多路开关构成或直接把几个三态反相器组合在一起构成。采用后一种方式时，每个三态反相器需要有一个译码使能信号，这些使能信号应当同时翻转以防止竞争。

​	反相和非反相多路开关都简称为多路开关或MUX。

### 1.4.9 时序电路(Sequential Circuit)

​	组合电路的输出仅取决于当前的输入；而时序电路的输出同时取决于当前和之前的输入。

​	如锁存器(latch)、触发器(flip-flop)这样的时序电路会接受一个时钟输入CLK和一个数据输入D，并产生一个输出Q。

- 一个D锁存器在CLK=1时透明(transparent)，即Q跟随D而改变;它在CLK=0时不透明(opaque)，即不管D如何变化, 仍保持它原来的值。	
- 一个沿触发的触发器(edge-triggered fip-flop)只在CLK的上升沿时将D复制到Q，而在其他时间均保持它原来的值不变。

#### 1.4.9.1 锁存器(Latch)

![image-20230423151013358](https://gitee.com/ephtiny/image/raw/master/img/202304231510515.png)

​	上图所示的锁存器为正电平灵敏锁存器，当使它的多路开关的控制连线反相位时，就变成了负电平灵敏锁存器

​	D锁存器也称为电平灵敏锁存器(Level-sensitive latch)，这是因为它的输出状态取决于时钟信号的电平

#### 1.4.9.2 触发器(Flip-Flop)

​	当将一个负电平灵敏和一个正电平灵敏连在一起时，就能构成边沿触发的触发器。第一级锁存器称为主锁存器(master)，而第二级称为从锁存器(slave)

![image-20230423155016911](https://gitee.com/ephtiny/image/raw/master/img/202304231550985.png)

​	当CLK 为低时，负电平灵敏主锁存器的输出(OM)跟随输入D而变化，此时正电平灵敏的从锁存器保持它原来的值(见图 (c))。当时钟从0 跳变到1时，主锁存器变为不透明并保持在时钟跳变时的D值，而从锁存器变为透明，将主锁存器所保存的值(QM)传送至从锁存器的输出(Q)。由于此时主锁存器已与输人D断开(见图(d))，因而输人D被阻止而不会影响输出。当时钟从1跳变至0时，从锁存器保持它的值而主锁存器开始再次采样输入数据。

![image-20230423155035550](https://gitee.com/ephtiny/image/raw/master/img/202304231550619.png)

​	一个好的设计会如(e)那样增加反相器来缓冲输入和输出，使它保持我们称之为“模块化”(modularity)的特性

​	这一触发器在时钟的上升沿时将 D复制到 Q，因此这一器件称为正沿触发的触发器(positive-edge triggered flip-lop)，也称为D触发器(D ip-flop)D 寄存器(Dregister)或主从触发器(master-slave flip-flop)

​	当使它的两个锁存器的极性都相反时就可以构成一个负沿触发的触发器

​	共享公共时钟输入的多个 D触发器的集合称为寄存器(register)。寄存器常常画成具有多位 D和Q总线的触发器。

​	如果系统的时钟偏斜(clock skew)太大，即由于时钟到达时间的不同使一个触发器触发得早些而另一个触发器触发得晚些，那么触发器就有可能发生保持时间(hold-time)失效。

![image-20230423161524045](https://gitee.com/ephtiny/image/raw/master/img/202304231615118.png)

​	可以采用两相位不重叠时钟的时序控制来完全避免保持时间问题。图1.33 为用两相不重叠时钟控制的触发器。只要两个相位在任何情况下都不重叠，那么无论何时至少有一个锁存器不透明，因而绝不会发生保持时间问题。

## 1.5 CMOS的制造和版图

​	晶体管制造在很薄的硅圆片(silicon waer)上，硅圆片用来作为机械支撑又用来作为电气上的公共节点，即所谓的衬底(substrate)。

​	在考察晶体管的物理版图时，我们先看一个完整 CMOS 反相器的横截面图，然后看它的顶视图并定义一组用来制造该反相器不同部分的掩模。晶体管和导线的尺寸由掩模的尺寸确定并受制造工艺分辨率的限制。

### 1.5.1 反相器的横截面图

![image-20230423162025597](https://gitee.com/ephtiny/image/raw/master/img/202304231620676.png)

​	nMOS 晶体管包含重掺杂的n型源区和漏区以及在二氧化硅(SiO)薄层(也称为栅氧，即gate oxide)上的多晶硅栅。n^+^和p^+^扩散区是指重掺杂的n型和p型硅。

​	两个晶体管的多晶硅栅在某处连在一起(图中未画出)形成输入A。

​	两个晶体管的漏用金属线连在一起形成输出 Y。

​	除了明确刻蚀了接触孔的位置而外，在金属层与其他层之间还有一层称为场氧(feld oxide)的厚二氧化硅(SiO层用来防止金属与其他层之间发生短路。



​	金属与轻掺杂半导体之间的结形成了只能沿一个方向传送电流的肖特基二极管(Schotky di-ode)。当半导体掺杂较重时，它与金属间形成良好的欧姆接触，因而对双向电流都呈现低阻。衬底必须连至低电位以避免p 型衬底和 nMOS 的n^+^源或漏之间的p-n 结发生正向偏置。同样，n阱必须连至高电位。通过增加重掺杂的衬底接触和阱接触(或称接头，即 tap)，可以将 GND(低电位)和 V~DD~(高电位)分别连至村底和n阱。



### 1.5.2 制造工艺

​	假定反相器由六层掩膜定义：n阱、多晶硅、n^+^扩散、p^+^扩散、接触和金属，实际掩膜组往往更复杂

![image-20230423162049049](https://gitee.com/ephtiny/image/raw/master/img/202304231620141.png)

![image-20230423162110242](https://gitee.com/ephtiny/image/raw/master/img/202304231621318.png)

- 制造过程从在一块p型硅的裸圆片上制作n阱开始。

![image-20230423212300600](https://gitee.com/ephtiny/image/raw/master/img/202304232123752.png)

​		加入掺杂剂有两种方法即扩散和离子注人。

- 接下来制作晶体管的栅，并为晶体管的有源区和阱接触形成n^+^区

![image-20230423215639228](https://gitee.com/ephtiny/image/raw/master/img/202304232156343.png)

​		多晶硅需要进行重掺杂，使它变成一种良好的导体

​		n^+^区通常是用离子注人的方法形成的，但它们在历史上曾经用扩散的方法，因而仍常称它们为n扩散区(n-diffusion)。在nMOS管上的多晶硅栅阻挡了扩散，因此源和漏被栅下的沟道隔开。这一工艺称为自对准工艺(self-aligned),因为晶体管的源和漏自动形成在邻近栅的两侧而不需要精确地对准掩模。

- 然后进行p扩散、使圆片与金属层之间绝缘需要生长场氧、将金属铝溅射在整个圆片上并填充接触孔

![image-20230423215652999](https://gitee.com/ephtiny/image/raw/master/img/202304232156088.png)

​		生长场氧时，需要用接触掩模形成图案(见图1.35(f)),以在金属应当与扩散或多晶硅相连的地方留出接 触孔(contact cut)(见图1.38(b))。

### 1.5.3 版图设计规则

​	版图设计规则说明了一个具体制造工艺能可靠密集制造的特征线条所允许的精细程度以及它们相互间允许的接近程度。工业界的设计规则常常以微米为单位来规定。

​	大学里常常采用可伸缩的设计规则来简化设计，这些设计规则比较保守，足以适用于许多种制 造工艺。Mead和Conway[Mead80]基于单个参数λ来表征工艺的分辨率，由此推广了可伸缩的设计 规则。λ一般是指所能设计的晶体管最小沟道长度的一半。沟道长度是晶体管源和漏之间的距离， 它由多晶硅线条的最小宽度确定。

​	λ规则比较简单和易 于按比例缩小，但它牺牲了基于微米的规则可能带来的格度优势。由于设计者经常用特征尺寸( fenture size)描述一种工艺，而特征尺寸是指晶体管的最小沟道长度，因此λ就是特征尺寸的一半。

​	180nm以下时，设计规则已变得非常复杂并且与具体的工艺有关，这使按比例伸 缩的设计规则很难应用。

![image-20230423222903068](https://gitee.com/ephtiny/image/raw/master/img/202304232229166.png)

![image-20230423222930651](https://gitee.com/ephtiny/image/raw/master/img/202304232229747.png)

​	在三层金属工艺中，第三层金属的宽度一般为6λ而间距为4λ。一般来说，在具有较多金属 层的工艺中，顶层金属线常常较厚、较宽因而具有较低的电阻。

​	晶体管的尺寸通常用它们的宽度/长度比(W/L)说明。带接触的最小宽度晶体管常常称为单位晶体管。

​	pMOS管往往 比nMOS管宽，因为空穴比电子移动得慢，因而pMOS管必须宽些才能传送相同的电流。

![image-20230423224040510](https://gitee.com/ephtiny/image/raw/master/img/202304232240585.png)

​	(a)为一个单位反相器的版图，它包含一个单位nMOS管和一个两倍尺寸的pMOS管。(b)为这个反相器的电路图，图中标注了每个晶体管的宽度/长度比。(c)为本书中常用的晶体管尺寸简咯表示方法，它假设采用最小的沟道长度而只表示出宽度是单位宽度的多少倍。

​	在数字系统中，晶体管一般都设计成具有尽可能小的沟道长度，因为沟道较短的晶体管较快、尺寸较小并且功耗也较低。

### 1.5.4 门级版图

​	这种简单的版图风格基于“扩散线”(line of diffusion)规则，常在自动版图系统中用来设计标准单元。

​	这一版图风格由 4行水平线条构成：单元底部的金属接地线、n扩散区、 p扩散区以及单元顶部的金属电源线。

![image-20230423224452766](https://gitee.com/ephtiny/image/raw/master/img/202304232244871.png)

​	可以用多晶硅线从顶部、底部或左侧连接到输人A。 输出Y可以用金属线从该单元的右侧引出。p衬底和n阱必须分别连至地和电源。



- nMOS的串联方式：
- pMOS的并联方式：

​	==电源和地线在左右两边都延长了2λ,这样如果两个门邻接起来的话，它们之间就将相隔4λ==,恰好满足设计规则。该单元的高度为36λ,但如果==考虑在这个单元和它上面的另一 条导线之间还应当有4λ的间距==时，它就是40λ

​	在现时的标准单元中，多晶硅一般不用来作为布线层，单元通过金属2至金属I以及金属1至多晶硅的接触连到每个栅上。这样做虽然会增大单元的尺寸，但它却能在金属布线层上自由连接到所有的端口上。

### 1.5.5 棒图

​	设计者在着手画完整的版图前需要有布置单元和预估面积的快速方法。棒图(stick diagram)是一种很容易画的图，因为它不需要按比例画。

![image-20230423233401266](https://gitee.com/ephtiny/image/raw/master/img/202304232334349.png)

​	版图的面积通常由金属导线决定

​	我们定义==布线通道(routing track)==为能布置一条导线并能满足它与相邻导线间的间距要求的足够空间。例如，如果导线宽度为4λ,它与相邻导线间的间距要求也是4λ,那么布线通道的节距(pitch)即中心距就是8λ,如图1.44(a)所示。这一节距也已足够在两条导线之间布 置一个晶体管(见图1.44(b))。因此，==通过统计金属布线通道的数目并将它乘以8λ来预估一个单元的高度和宽度==是很合理的

![image-20230423233948086](https://gitee.com/ephtiny/image/raw/master/img/202304232339212.png)

​	由于有阱的原因，在nMOS和pMOS管之 间要求有12λ的间距，即在nMOS和pMOS管之间必须多分配一条额外的导线通道而不管实际上是否有导线使用它



​	图1.46中有四条垂直方向的导线通道（按我的理解是如图1.44的为导线通道，即头带黑框的），乘以每通道8λ的节距就可知单元宽度为32λ;而由五条水平方向的通道（这里没有按比例画）就可知单元高度为40λ。

![image-20230423234014980](https://gitee.com/ephtiny/image/raw/master/img/202304232340082.png)

## 1.6 设计划分(Design Partitioning)

​	现代VLSI设计中最大的挑战在于如何处理系统的复杂性

​	设计任务会划分给多个工程师团队。此时任务划分会出现两个极端：如果划分得太严格，那么每个功能块在进行优化时就可能没有考虑到其相邻功能块的情况，从而导致最终的系统性能很姜。相反，如果每项任务都和其他任务相互依赖，那么设计就将进展太慢

​	设计过程将经过多个抽象层 次，这些层次隐去了许多设计细节直到必须用到它们时才出现。实际中都采用结构化的设计方 法(structured design),这一方法也用在大的软件开发项目中。它利用层次化(hierarchy)、规整化 (regularity)、模块化(modularity)和局域化(localiy)的原理来驾驭系统的复杂性。

### 1.6.1 设计抽象(Design Abstraction)

​	数字VLSI设计常常划分成五个抽象层次：体系结构(architectue)设计、微结构(microarchiteeture)设计、逻辑(logic)设计、电路(circuit)设计和物理(physical)设计

- 体系结构描述系统的功能
- 微结构描述体系结构如何划分成寄存器和功能部件
- 逻辑设计描述如何构成功能部件
- 电路设计描述如何用晶体管实现逻辑
- 物理设计描述芯片的版图

​	这些设计要素有内在的相关性，它们都会影响每一个设计目标。为了解决这些相互依赖的问题，微结构、逻辑、电路和物理设计必须并行进行，或至少一部分应当如此。

### 1.6.2 结构化设计

​	层次化(hierarchy)是处理复杂设计的关键手段。一个大系统可以分层次地划分成几个核 (core),每个核由各种部件(unit)构成，每个部件又由多个功能块(functional block)构成。这些功能块再由单元(cell)组成，单元最终由晶体管实现。可以把设计层次看成是一种树结构，即整块芯片是根(root)而基本单元是叶(leaf)。

​	规整化(regularity)通过尽可能设计种类数目最少的不同功能块来降低设计的复杂性。

​	模块化(madularity)要求每个功能块都有确切定义的接口以避免未预想到的相互影响。

​	域化(locality)是指将信息保持在使用它的物理位置和时间段上。

### 1.6.3 行为、结构和物理设计域

![image-20230425162403644](https://gitee.com/ephtiny/image/raw/master/img/202304251624806.png)

​	上面三个设计域可以用来描述几乎所有的人工产品设计，因而是通常描述设计过程的分类方法。

- 行为域描述一个具体系统完成什么任务。
- 结构域描述为实现一个具体的行为需要怎样将各个模块互连在一起。
- 物理域描述说明如何在实际上(物理上)实现这一抽象层次。

​	可以将设计过程看成是完成从一个设计域转换到另一个设计域但仍保持各个域之间等价性的过程。通常在实际设计中都需要对一个域到另一个域的转换进行验证。

​	Y图可以用来说明每个设计域以及在各个设计抽象层次上设计域之间的转换。当设计过程从外圈逐渐绕到里圈时，它就从较高的抽象层次和等级过渡到较低的抽象层次和等级。

## 1.7 举例：一个简单的MIPS微处理器

​	下面将描述MIPS的体系结构以及将要实现的多周期微结构。若不熟悉计算机体系结构，可以将MLPS处理器看成是一个黑盒子，直接看1.8节

### 1.7.1 MIP体系结构

​	这个体系 结构子集采用32位指令编码但只有八个8位的通用寄存器($0~$7)。另外还有一个8位的程序 计数器(Program Counter,PC)。寄存器0通过硬布线使它的各位都含数字0。指令有ADD(加)、 SUB(减)、AND(按位与)、OR(按位或)、SLT(小于时置1)、ADDI(立即数加)、BEQ(相等时转移)、 J(跳转)、LB(取字节)和SB(存字节)。

![image-20230425165605453](https://gitee.com/ephtiny/image/raw/master/img/202304251656547.png)

![image-20230425165642261](https://gitee.com/ephtiny/image/raw/master/img/202304251656313.png)

​	我们可以用汇编语言(assembly language)为MIPS处理器编程，不过一般用高级语言(high-level language)如C或Java编程。编译器(compiler)将一个程序从高级语言的源代 码(source code)转换成合适的机器语言的目标码(object code)。

![image-20230425170250463](https://gitee.com/ephtiny/image/raw/master/img/202304251702536.png)

![image-20230425170259462](https://gitee.com/ephtiny/image/raw/master/img/202304251702524.png)

![image-20230425170310242](https://gitee.com/ephtiny/image/raw/master/img/202304251707833.png)

![image-20230425170322899](https://gitee.com/ephtiny/image/raw/master/img/202304251703956.png)

### 1.7.2 多周期MIPS微结构



## 1.8 逻辑设计

​	我们从定义顶层的芯片接口和方块图开始逻辑设计，然后逐层分解部件直至得到叶子单元。我们利用硬件描述语言(Hardware Description Language,HDL)来描述逻辑。这一描述代码常称为寄存器传输级(Register Transfer Level,RTL) 描述。

### 1.8.1 顶层接口

![image-20230425170548085](https://gitee.com/ephtiny/image/raw/master/img/202304251705143.png)

​	这里采用两相位时钟系统以避免保持时间(hold-time)问题。复位(Reset)信号使PC初始化为0因而控制FSM回到起始状态。

![image-20230425170621703](https://gitee.com/ephtiny/image/raw/master/img/202304251706763.png)

​	处理器送出8位的地址Adr并根据要求决定是否将Merwrite置为有效。在读周期时，存储器将送出一个值并放到MemData线上，而在写周期时，存储器将接受来自WriteData线上的输入。

​	在许多系统中，MemData和WriteData可以合成为一条双向总线，但在本例中我们仍 保留图1.53中的接口。

### 1.8.2 方块图

![image-20230425172644635](https://gitee.com/ephtiny/image/raw/master/img/202304251727384.png)

- 控制器包括控制 FSM、ALU译码器和两个用来产生PCEn信号的逻辑门。
- ALU译码器由组合逻辑构成用来产生 ALUContmol信号。
- 芯片的其余部分为8位的数据通路。可以把它看成是字片(wordslice)或位片(bitslice)的集合。字片含一列8位的触发器、加法器、多路开关或其他元件

![image-20230425172724510](https://gitee.com/ephtiny/image/raw/master/img/202304251727585.png)

​	它含有8个独立的一位2:1多路开关，以及一个由缓冲器和反相器 构成的拉链电路(zipper)用来驱动所有这8个多路开关的正反选择信号。

​	这种不在各个多路开关中设置反相器而是把这些驱动器提取出来集中用一个拉链电路驱动的方式可以节省许多空间。

​	我们可以把数据通路看成是8行位片。每个位片含各个组件中的-·位以及将这些位连 在一起的水平导线。



​	芯片划分受物理设计规划的影响。数据通路含大部分的晶体管并凡结构非常规整。通过==手工设计每一字片或位片然后把这些电路像瓦片那样铺在一起==可以使我们花费不多的功夫就能达到很高的密度。==通常利用字片构成数据通路==比较容易，因为某些结构如ALU中判“O”(判断是否为零)的电路在各个位片中并不相同。但是考虑位片形式对于规划穿越数据通路的布线很有帮助。控制器的结构性要差得多。用手工将FSM转换成逻辑门非常麻烦，而且在一个新的设计中，控制器是最有可能出现故障的部分并且常常到设计的最后阶段还要修改。因此，我们将==用硬件描述语言较为抽象地描述控制器，并用综合(synthesis) 和布局布线(place&route)工具或可编程逻辑阵列(Programmable Logic Array,PLA)自动生成它==。

### 1.8.3 设计层次

![image-20230425215418450](https://gitee.com/ephtiny/image/raw/master/img/202304252154530.png)

​	在逻辑、电路和物理设计中的设计层次不一定需要完全相同。例如，从邃辑角度看，最好将存储器看成是一个黑匣子，而在电路实现时，它可以划分成译码器、存储单元阵列、列多路开关等。但设计层次各不相同将使验证复杂化，因为它们必须被展平(flartened)直到它们都一致为止。因此实际设计时，最好使逻辑、电路和物理的设计层次尽可能一致。

### 1.8.4 硬件描述语言

​	在将方块图和FSM的状态转移图转换成电路原理图之前最好先确认一下顶层设计是否存在需要我们完全重新设计的严重错误。硬件描述语言(HDL)提供了一种在较高抽象层次上描述设计的方法，它能提高设计者的设计效率。

​	当前两种最流行的HDL是Verilog和VHDL。Verilog比较简明并接近C语言的句法，而VHDL支持对大团队项目很有用的某些抽象功能。无论哪一种语言都没有对另一种语言的绝对优势，所以工业界不得不同时支持这两种语言

​	当用HDL编码时，应当注意你是在描述==并行操作的硬件==而不是顺序执行的软件。有两种一般的编码方式：结构级(structural)HDL描述一个单元如何由其他单元或基本逻辑门及晶体管组成，而行为级(behaviaral)HDL描述这个单元做什么。

​	==逻辑模拟器(logic simulator)用来模拟HDL代码==，它能报告模拟结果是否与期望结果相符，并能显示波形以帮助查找出现差别的原因。逻辑综合(logic synthesis)工具类似于一个硬件编译器：它将HDL代码映射到一组称为标准单元(standard cell)的逻辑门库(library)上，使面积尽可能小且能满足某些时序约束(timing constraint)。但只有部分HDL结构是可综合的，本书附录将重点列出这一子集。

​	由逻辑综合生成的电路一般总不如由经验丰富的设计者手工完成的电路面积小和速度快。但集成电路工艺现在已很先进，因此综合生成的电路对于今天所需的绝大多数专用集成电路(Application-Specitic Integrated Circuit,ASIC)来讲已足够好，它们的版图可以用布局布线工具自动生成。



​	附录A.12列出了MIPS处理器的Verilog和VHDL模型。在Verilog中，每个单元称为模块(module)。它的输入/输出说明与C程序中的说明非常类似，其中总线是用位宽(bit width)来表示的。内部信号也必须用与局部变量相类似的方式表示。这一处理器在==顶层上用结构级Verilog分层次地描述==，而对==叶子单元采用行为级Verilog描述==。

​	例如，控制器模块显示了如何用行为级Verilog描述有限状态机而aludec模块显示了如何描述复杂的组合逻辑。数据通路用字片(wordslice)进行结构级描述，而字片再进行行为级描述。

![image-20230425224743209](https://gitee.com/ephtiny/image/raw/master/img/202304252247287.png)

​	我们可以把一个8位的加法器字片在结构上描述成由8个全加器串联起来组成的一个串行进位加法器。全加器可以在结构上表示成一个求和(sum)子电路和一个进位(cary)子电路。求和及进位子电路又可以用行为级来描述

![image-20230425224907052](https://gitee.com/ephtiny/image/raw/master/img/202304252249129.png)

## 1.9 电路设计

​	电路设计涉及安排晶体管去执行一个具体的逻辑功能。有了电路设计就可以估计出它的延时和功耗。电路可以表示成电路原理图，或用文本方式表示成网表(netlist)。常用的晶体管级网表格式包括Verilog和SPICE。Verilog网表用于功能验证，而SPICE网表含进行延时和功耗模拟所必需的更多细节。



​	由于晶体管栅是良绝缘体，所以可以把它建模成一个电容C。当晶体管导通时，在它的源和漏之间就会有某个电流I流动。这一电流和电容的大小都与晶体管的宽度成正比。

![image-20230425225458021](https://gitee.com/ephtiny/image/raw/master/img/202304252254079.png)

​	一个逻辑门的延时由它能提供的电流及它所驱动的电容决定，如图1.60中一个反相器驱动另一个反相器的情形所示。==电容的充电和放电由以下基本方程决定：$I = C\frac{dV}{dt}$==

​	如果考虑==I为平均电流==，那么==使电压在0和Vo之间翻转的时间t为：$t = \frac CIV_{DD}$==,因此延时随负载电容增加而增大，随驱动电流增加而减小。

​	充电和放电负载电容都需要能量，这称为动态功耗(dynamic power),因为它是在电路快速翻 转过程中消耗的功耗。当一个电容以频率f充放电时，它所消耗的==动态功耗为：$P_{dynamic} = CV^2_{DD}f$==

​	即使在逻辑门不翻转时，它也消耗一定的静态功耗(static power)。这是因为一个关断的晶体管总 是有泄漏的，即总会有一个小电流      l~static~在电源和地之间流动，从而引起==静态功耗：$P_{static} = I_{static}V_{DD}$==



​	在许多设计方法学中，逻辑综合工具能寻找能最佳实现电路的标准单元。但当一个系统对高速度和低功耗有特殊要求或将大批量生产因而值得花费额外的工程代价时，对该芯片的关键部分采用定制电路设计就显得十分重要。

![image-20230426133329528](https://gitee.com/ephtiny/image/raw/master/img/202304261333663.png)

​	图1.61为全加器中进位电路的两种不同的电路设计。图1.61(a)中的门级设计共需要26个晶体管和4级门延时(如前所述，与门和或门由与非门和或非门在后面接反相器构成)。而图1.61(b)中的晶体管级设计只需要12个晶体管和两级门延时，这表明了利用CMOS工艺的优点优化电路设计时所能带来的好处。

- 门级设计生成的网表

![image-20230426134019401](https://gitee.com/ephtiny/image/raw/master/img/202304261340485.png)

- 晶体管级网表

![image-20230426134127325](https://gitee.com/ephtiny/image/raw/master/img/202304261341395.png)

晶体管的表示方式如下：

​	晶体管类型名称(漏，源，栅); 

​	tranifl代表栅电压为1时导通的nMOS晶体管，而tranif0代表栅电压为0时导通的pMOS晶体管。



​	至此还未决定逻辑门速度或功耗所需的信息，还需要说明晶体管的尺寸和寄生电容。这时候需要使用SPICE电路模拟器所使用的结构语言。例如，晶体管级进位子电路的电路级描述可以表示如下：

![](https://gitee.com/ephtiny/image/raw/master/img/202304261352186.png)![image-20230426135146424](https://gitee.com/ephtiny/image/raw/master/img/202304261351522.png)

​	其中晶体管按行说明，说明行以字母M开头：

![image-20230426135305279](https://gitee.com/ephtiny/image/raw/master/img/202304261353333.png)

​	MOS开关实际上是四端口器件，其中衬底或阱形成体端(hody terminal)。虽然Verilog中不列出体的连接，但在SPICE中必须有它。类型(type)用来说明晶体管是p型器件还是n型器件，而宽度(width)、长度(length)和面积参数说明实际晶体管的物理尺寸。它们的单位包括U(micmo表示“微”,即10^-6^)、P(pico表示“皮”,即10^-12^)和F(femto表示“飞”,即10^-15^)。

​	电容也按行说明，但以字母C开头：

![image-20230426135110217](https://gitee.com/ephtiny/image/raw/master/img/202304261351270.png)



​	在以上子电路的描述中，SPICE中的MOS模型根据所说明的器件尺寸计算出MOS晶体管中固有的寄生电容。而在以上描述中额外的电容语句用来表示非器件结构本身固有的附加布线电容，它的大小取决于逻辑门的物理设计。

​	此外，较长的导线也表现出较大的电阻，这将使延时加大。在电路级的结构描述中列出了所有的连线，它们对于完整表征进位门的速度，功耗和连接关系是必不可少的。

## 1.10 物理设计

### 1.10.1 平面规划

物理设计首先从平面规划(floorplan)开始

用处：估计芯片中主要部件的面积并定义它 们间的相对位置

重要性：决定所提出的设计方案是否能满足芯片面积的预算要求 并能估计出布线长度和布线的拥挤程度。

难点：需要在着手进行芯片的细节设计(它取决于平面规划和布线长度)之前预先估计出每个部件的尺寸

​	平面规划中常常会提出修改逻辑(和微结构),但这些修改又反过来会要求调整平面规划。

![](https://gitee.com/ephtiny/image/raw/master/img/202304261412696.png)

​	顶层功能块是控制器和数据通路。布线通道位于这两个功能块之间以提供空间把控制信号布线到数据通路。数据通路进 一步划分成字片。焊盘框(pad frame)包含40个I/O焊盘，它们用导线连接到芯片封装的引脚 (pin)上。其中29个焊盘用于信号，其余为V~DD~和GND。

![image-20230426142125560](https://gitee.com/ephtiny/image/raw/master/img/202304261421638.png)

![image-20230427210618050](https://gitee.com/ephtiny/image/raw/master/img/202304272106305.png)

​	紧邻焊盘框内侧的是金属层2 (metal2)的V~DD~和GND环，分别标注了“+”和“-”。

​	片上的结构可以分类为随机逻辑(random logic)、数据通路(datapath)、阵列(aray)、模拟电路(analog)以及输入/输出(input/output)即I/O

- 随机逻辑如aludecoder(ALU译码器),几乎没有什么规则的结构
- 数据通路对多位数据字进行操作但对每位几乎执行相同的功能，所以它们由多个N位的字片构成
- 阵列结构如RAM、ROM和PLA,由在二维方向上重复出现的相同的单元构成

​	随机逻辑和数据通路一般都用标准单元( standard cell)如反相器、与非门和触发器等构成。

​	MIPS平面规划采用水平走向的金属1(metall)导线、垂直走向的金属2(metal2)导线以及水平走向的金属3(metal3)导线。在每两层间交替走向能够很容易地通过不同的布线层横跨导线。

### 1.10.2 标准单元

​	电源和地线是水平走向的金属1。衬底和阱的接触布置在电源轨线的下面。输入和输出由垂直走向的金属2提供。

![image-20230427212724447](https://gitee.com/ephtiny/image/raw/master/img/202304272127548.png)

​	这是用自动布局布线 (place&route)工具生成。

​	在有两层金属的工艺中，水平走向的金属1导线布置在行之间的布线通道(routing channel)内。当有更多的金属层可用时，由于可以在单元上方布线，所以也许就不再需要布线通道了。

![image-20230427213007774](https://gitee.com/ephtiny/image/raw/master/img/202304272130900.png)

​	图1.65为整个8位MIPS处理器的版图，它由附录A.I2中的VHDL模型采用130nm七层金属工艺的单元库综合而成。

​	由综合得到的设计往往比一个好的定 制设计速度慢些，但设计它们所花费的努力也要少一个数量级。

### 1.10.3 节距匹配

​	通过把导线包含在“咬接”(snap together)单元内可以提高版图的密集度。咬接单元的设计和版图绘制需要花费较大的努力，但它能减小面积和缩短导线长度(因而速度更快)。

​	设计咬接单元的关键是节距匹配(pitch-matching),相连的单元必须沿连接边有相同的尺寸，下面是咬接单元的例子

![image-20230427214138453](https://gitee.com/ephtiny/image/raw/master/img/202304272141530.png)

![image-20230427214155698](https://gitee.com/ephtiny/image/raw/master/img/202304272141858.png)

​	这是MIPS数据通路的细节。版图顶部包括三行拉链电路用来驱动译码器，译码器的节距与数据通路中寄存器堆的节距相匹配。垂直方向的金属2导线用于控制，包括时钟、多路开关选择和寄存器使能信号。水平方向的金属3导线在单元上方布线，它们沿位片传送数据。

### 1.10.4 分片规划

![image-20230427214702031](https://gitee.com/ephtiny/image/raw/master/img/202304272147128.png)

​	上图显示了字片的拌列顺序以及在每一个位片内导线通道的分配情况。圆点表示有一条总线在单元上方通过并且也用于该单元。每一单元都标注了它的类型和宽度(用通道数目表示)。

​	分片规划对估计数据通路的面积很重要，每个字片都标注了用通道(track)数表示的宽度。

### 1.10.5 阵列

![image-20230427215337276](https://gitee.com/ephtiny/image/raw/master/img/202304272153404.png)

​	PLA可以计算用“积之和”(sum of products)形式表示的任何逻辑函数。

​	在这个PLA版图中，每个输入使用两条垂直通道，每个输出使用三条垂直通道，再加上6条 垂直通道用于其他开销，每个“积项”即“小项”(minterm)使用1.5条水平通道，再加上14条水平通道用于其他开销，这样可以计算出PLA的尺寸。其总面积为500λ×350λ再加上另外的336λ×220λ用于控制FSM所需要的4个外部触发器。控制器的高度由PLA的高度加上布置输入和输出的几条导线通道决定。

### 1.10.6 面积估算

![image-20230427215925354](https://gitee.com/ephtiny/image/raw/master/img/202304272159420.png)

估算时需要注意：

- 一定要包括节距为8λ通道的较大的布线通道。
- 大的晶体管显然会占据较大的面积，因此可以把它作为W和L(宽度和长度)的函数在估算面积时作为考虑因素。
- 对于存储器，不要忘记译码器和其他外围电路，因为它们往往会占据和存储位本身同样多的面积。
- 数据通路和阵列通常都能达到比标准单元更高的密度。

## 1.11 设计验证

​	一个设计通常是在体系结构级用一个像C语言这样的模型和在逻辑级通过模拟它的HDL描述来测试它的功能。

![image-20230427220607300](https://gitee.com/ephtiny/image/raw/master/img/202304272206366.png)

​	标准测试程序(testbench)用来验证逻辑是否正确，它使待测逻辑实例化（附录A.12有例子）

​	特殊电路应当进行全面的模拟以保证它们执行预期的 逻辑功能并具有合适的噪声容限。

​	版图对照原理图(Layout vs. Schematic,LVS)工具检查版图中的晶体管连接方式是否与在电路原理图中的相同。设计规则检查(Design Rule Checkers,DRC)用来验证版图是否满足设计规则。电气规则检查(Electrical Rule Checkers,ERC)将搜索其他潜在的问题，如噪声或早期损耗(premature wearout)

## 1.12 制造、封装和测试

- 掩模制造就是用电子束将玻璃上的铬层刻蚀出图案来

​	单个的硅圆片上将同时制造出许多芯片。圆片的直径一般为150～300nm(6～12英寸)。芯片制造需要进行多次的淀积(deposition)、掩模(masking)、刻蚀(etching)和注人(implant)步骤。

- 加工好的圆片将划片成管芯(die),即芯片(chip),并进行封装(package)
- 圆片上甚至一个非常微小的缺陷或者灰尘颗粒都可能使芯片失效。芯片在销售前必须经过测试。

# 2. MOS晶体管原理

## 2.1 引言

![image-20230427222357610](https://gitee.com/ephtiny/image/raw/master/img/202304272223682.png)

​	a中的三端符号在绝大多数电路图中采用；b中四端符号用于需要显示出体(衬底或阱)的连接的电路



​	MOS晶体管是一个多数载流子(majority-camier)器件，它在源漏之间导电沟道中的电流受施加在栅上的电压控制。在nMOS管中，多数载流子为电子；而在pMOS管中，多数载流子为空穴

![image-20230427222657435](https://gitee.com/ephtiny/image/raw/master/img/202304272226506.png)

- (a)中，一个负电压加在栅上，所以在栅上出现了负电荷。于是带正电荷的可移动空穴被吸引到栅下的区域。这称为积累(accumulation)状态
- (b)中，一个小的正电压加在栅上，使栅上产生一些正电荷，于是体中的空穴从栅正下方的区域中被排斥开，从而在栅下形成了一个耗尽(depletion)区
- (c)中，一个更高的正电压加在栅上，它超过了临界的阈值电压V,因而在栅上吸引了更多的正电荷，于是空穴被进一步排斥开并且体中的一些自由电子将被吸引到栅下的区域。这一在p型体硅中的电子导电层称为反型(inversion)层

​	阙值电压取决于体中掺杂剂的数量和栅氧层的厚度t~ox~，通常为正值

![image-20230427223445974](https://gitee.com/ephtiny/image/raw/master/img/202304272234078.png)

- (a)中，==栅至源的电压V~gs~小于阙值电压==。体和源或漏之间形成的结为==零偏置或反偏置==，所以晶体管中几乎没有或完全==没有电流流过==。晶体管关断。这一 工作状态为截止(cutoff)状态

  流过关断晶体管的少量泄漏电流有可能产生严重影响

- (b)中，==栅电压大于阈值电压==。一个称为沟道(channel)的电子(多数载流子)反型区将源和漏连接起来，形成了一条导电通路使晶体管导通。==载流子的数目和导电性随栅电压的增加而增加==。果V~ds~=0(即V~gs~=V~gd~),那么就不存在任何电场可以帮助驱使电流从漏极流向源极。

- (c)中，当一个小的正电压V~ds~加在漏极上时，电流I~ds~将通过沟道从漏极流向源极。这一工作状态称为线性(linear)、电阻性(resistive)、三极管(triode)、非饱和(nonsaturated)或不饱和(unsaturated)状态，此时==电流同时随漏极电压和栅极电压的增加而增加==。

- (d)中，==V~ds~变得足够大使V~gd~<V~t~==，漏极附近的沟道就不再能反型而被夹断(pinched off)，但由于电子在漏极正电压影响下的漂移作用使==晶体管仍然导通==。

  当电子到达沟道末端时，它们射人到漏极附近的耗尽区中并加速流向漏极。==当滑极电压进一步提高时，电流I~ds~将只受栅电压的控制==而不再受漏极电压的影响，此时的工作状态称为饱和(saturation)状态。

​	总之，nMOS管有三个工作状态。**如果V~gs~<V~t~,晶体管截止(关断)**。**如果V~gs~>V~t~晶体管导通**。**当V~ds~较小时，晶体管的作用像是一个线性电阻，它的电流正比于V~ds~**。**当V~gs~>V~t~且V~ds~较大时，晶体管的作用像是一个电流源，它的电流将与V~ds~无关**。

![image-20230427223501260](https://gitee.com/ephtiny/image/raw/master/img/202304272235328.png)

​	pMOS管的工作方式恰好相反。由于n型体硅连至高电平，所以体与p型源极和漏极间形成的结通常反向偏置。**当栅也处在高电平时，漏和源之间没有任何电流流动**。**当栅电压下降了一个阈值电压V~t~时，它将吸引空穴直接在栅下形成p型沟道，使电流能在漏和源之间流动**。

​	们采用V~tn~和V~tp~两项来区分nMOS和pMOS的阈值。



​	习惯上我们都说多数载流子从它们的源流向它们的漏。在静态CMOS门中，晶体管的源极是靠近电源轨线的端口，而漏极是靠近输出的端口。

​	**nMOS管的源极**是源、漏两端口中**电平较低**的一个；**MOS管的源极**是这两端中**电平较高**的一个



​	MOS电路的延时取决于这一电流充电或放电这个电路的电容所需要的时间

​	MOS管的栅极在本质上就是一个具有很薄电介质的良好电容。这一电容的作用就是把裁流子吸引到沟道中而使晶体管工作。

​	从源或漏至体的p-n结是形成附加寄生(parasitic)电容的来源

## 2.2 长沟道晶体管的I-V特性

​	MOS晶体管有三个工作区域：**截止或亚阈值区**、**线性区**、**饱和区**

​	

​	在长沟道模型(long channel)（理想(ideal)、一阶(first-order)或肖克利(Shockley)模型）中，假设沟道足够长，因此横向电场(源和漏之间的电场)相对较弱（这一假设对于纳米器件已不再成立）

​	长沟道模型假设流过一个关断晶体管的电流为0。当晶体管导通(V>V?)时，栅极将吸引载流子(这里是电子)形成沟道。电子以一个与源漏间电场成正比的速率从源极漂移到漏极

​	由在电容每个极 板上的电荷为Q=CV知
$$
Q_{channel}=C_g(V_{gc}-V_t)
$$
​	C~g~为概与沟道间的电容，而V~gc~-V~t~,是超出使p型沟道反型为n型沟道所需最小电压值以外的栅极电压(栅相对于沟道)部分.如果源极电压为V~s~而漏极电压为V~d~那么沟道中的平均电压V~c~=(V~s~+V~d~)/2=V~s~+V~ds~/2。因此在栅电压和沟道电压之间的平均差V~gc~为V~g~-V~c~=V~gs~-V~ds~/2

![image-20230427231658025](https://gitee.com/ephtiny/image/raw/master/img/202304272316116.png)

​	将栅建模为一个平行板电容器，它的电容值正比于平板面积与介质厚度之比。如果栅的长度(即沟道长度)为L,栅的宽度(即沟道宽度)为W,并且栅氧厚度为t~ox~，如图2.6所示，那么栅电容为：
$$
C_g=k_{ox}\epsilon_0\frac{WL}{t_{ox}}=\epsilon_{ox}\frac{WL}{t_{ox}}=C_{ox}WL
$$
​	![image-20230427232410452](https://gitee.com/ephtiny/image/raw/master/img/202304272324532.png)



## 2.3 C-V特性

## 2.4 非理想的I-V效应

## 2.5 直流传输特性

## 2.6 常见隐患与误区

# 3. CMOS工艺技术

## 3.1 引言

## 3.2 CMOS工艺

## 3.3 版图设计规则

## 3.4 CMOS工艺增强技术

## 3.5 与工艺相关的CAD问题

## 3.6 有关制造的问题

## 3.7 常见隐患与误区

## 3.8 历史透视

# 4. 延时

## 4.1 引言

## 4.2 瞬态响应

## 4.3 RC延时模型

## 4.4 线性延时模型

## 4.5 路径逻辑努力

## 4.6 用于时序分析的延时模型

## 4.7 常见隐患与误区

## 4.8 历史透视



# 附录 硬件描述语言