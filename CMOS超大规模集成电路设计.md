# 1. 引论

## 1.1 集成电路简史

晶体管(Transistor)发展历程：点接触式晶体管 -> 双极型晶体管 -> 半导体场效应管(MOSFET)

晶体管：

- 一个电阻或半导体器件，当电信号从它的输入端通过它传输到输出端时会被放大
- 可以看成一个电控开关，有一个控制端和另外两个端口，取决于加在控制端上的电压或电流，这两个端口将连通或断开。1

双极型晶体管：

- 需要将一个小电流输入到控制端（基极）以通断另外两个端口（发射极和集电极）之间大得多的电流
- 基极电流在电路不翻转时仍然存在，由它们引起的静态功耗限制了最多能集成在单个管芯上的晶体管数目
- 相对较可靠、噪声低，且功率效率高

半导体场效应(MOSFET)：

- 有两种类型：nMOS和pMOS，分别采用n型硅和p型硅
- 闲置状态下的控制电流几乎为零



互补金属氧化物半导体，即CMOS：首批MOSFET逻辑门，同时采用nMOS和pMOS晶体管。电路采用分离器件晶体管，但功耗只有几纳瓦，相对双极型电路，功耗减低了六个数量级



摩尔定律：单芯片上的晶体管数目没18个月就会翻一倍

尺寸缩小定律：晶体管尺寸缩小时，它们将变得更快，功耗更小，且制造成本更低



芯片的集成度分为小规模、中规模、大规模和超大规模

- 小规模集成(Small-Scale Integration, SSI)电路如7404反相器，含10个以下的逻辑门，每个门大约由6个晶体管组成
- 中规模集成(Medium-Scale Integration, MSI)电路如74161计数器，含多至1000个门
- 大规模集成(Large-Scale Integration, LSI)电路如简单的8位微处理器，含至多10 000个门
- 超大规模(Very Large-Scale Integration, VLSI)电路用于描述自20世纪80年代以来的大多数集成电路



​	虽然单个CMOS晶体管每次开关时只需消耗很少的能量，但巨大数目的晶体管以非常高的速率开关时所产生的功耗再次称为设计的主要考虑因素。而且当晶体管的尺寸变得很小时，它们就不能完全关断。因而虽然经过每个晶体管的泄露电流很小，但当一块芯片上有上亿个晶体管时将会导致非常大的功耗



CMOS制造工艺的特征尺寸：可靠生产处的晶体管的最小尺寸

​	制造商每两三年就开发处特征尺寸再缩小30%的新一代工艺（也称为工艺节点），使再相同的芯片面积上能集成多两倍数目的晶体管

​	微米工艺中较不显著的效应，如晶体管的泄露电流、相邻晶体管之间的特性扰动以及导线电阻等在纳米工艺中将变得非常显著

​	每个晶体管的光刻成本在下降，但一次就能成功的设计成本却一直呈指数规律增长



## 1.2 概述

​	随着单芯片上晶体管数目的急剧增长，设计者已开始依靠不断提高自动化水平来寻求获取相应的生产效率。许多设计者把他们的主要精力放在用硬件描述语言描述功能而很少去注意实际的晶体管。但芯片设计不是软件工程。解决较困难的问题需要对电路和物理设计有基本的理解

​	学习VLSI设计的最好方法就是亲自实践，`www.cmosvlsi.com`网站上提供了一组实验训练以指导你设计自己的微处理芯片



## 1.3 MOS晶体管

​	硅是大多数集成电路的基础原材料。纯净的硅由三维的原子晶格(lattice)组成。纯净的硅是一种不良导体，但它的导电性可以通过在硅晶格中引入称为掺杂剂(dopant)的少量杂质来提高

​	砷(As)掺杂（V族元素）,室温下的晶格热振动可以使砷的第五个价电子自由运动，形成一个带整点的As^+^离子和一个自由电子，该自由电子可以携带电流，从而提高了材料的导电性。这类半导体的自由载流子是==带负电荷的电子==，所以称之为==n型半导体==

​	硼(B)掺杂（III族元素），它可以从相邻的硅原子中借一个电子，使这个硅原子因此缺少一个电子，而这个硅原子又向相邻的硅原子借电子，以此类推会出现”空穴“在晶格中传播。空穴的作用像一个==带正电荷的载流子==，所以称这类半导体为==p型半导体==



二极管：p型和n型硅之间形成的结

- ==当作阳极的p型半导体上的电压高于作阴极的n型半导体时，二极管**正向偏置**，有电流流过==。反之则==**反向偏置**，几乎无电流==

 金属-氧化物-半导体(MOS)结构是通过把几层到点和绝缘材料叠在一起形成类似三明治的结构而构成的

CMOS工艺提供两种类型的晶体管，它们也称为器件(device)：n型晶体管(nMOS)和p型晶体管(pMOS)

![image-20230421213617184](https://gitee.com/ephtiny/image/raw/master/img/202304212136891.png)

图1.9中n^+^和p^+^区域表好中掺杂的n型或p型硅

​	晶体管的工作是由电场控制的，所以这些器件又称为金属氧化物半导体场效应晶体管(MOSFET)

​	每个晶体管由一层导电栅(gate)、一层二氧化硅绝缘层以及一层硅基底（也称衬底、体、体硅）堆叠构成，这一叠层结构杯称为金属-氧化物-半导体或MOS（早起栅由金属形成，现在用多晶硅）。

​	在同时有这两种类型晶体管的CMOS工艺中，衬底可以使n型的，也可以是p型的，但类型与衬底上晶体管不同的另一种晶体管必须构造在专门的阱(well)中，阱中加入了掺杂院子以形成相反类型的衬底

​	源和漏是完全一样的，可以互换。栅是一个控制输入：它影响电流在源和漏之间的流动

- 对于nMOS管。其衬底一般接地，而源和漏雨衬底之间的p-n结都是反向偏置的。如果栅也接地，那么不会有电流流过反偏结，于是称此时晶体管关断。如果提高栅电压，会建立一个电场将自由电子吸引到Si-SiO~2~的界面下，栅压足够高时电子数目将超过空穴，栅下方称为”沟道“(channel)的一层区域将反型称为n型半导体，源和漏之间形成通路，此时晶体管导通
- 对于pMOS管则相反。其衬底保持在正电压。pMOS管的行为与nMOS管相反，其符号在栅极上有个小圆圈，就如逻辑门中反相器符号图上的小圆圈

![image-20230421220529532](https://gitee.com/ephtiny/image/raw/master/img/202304212205607.png)

图1.10中g、s和d分别表示栅、源和漏



## 1.4 CMOS逻辑

### 1.4.1 反相器

![image-20230421220707493](https://gitee.com/ephtiny/image/raw/master/img/202304212207572.png)

CMOS反相器（即非(NOT)门）由一个nMOS管和一个pMOS管构成。当输入A为0时，n关断而p导通，Y连至V~DD~，即输出Y为1。

![image-20230421221117543](https://gitee.com/ephtiny/image/raw/master/img/202304212211615.png)



### 1.4.2 与非(NAND)门

![image-20230421221305213](https://gitee.com/ephtiny/image/raw/master/img/202304212213289.png)

![image-20230421221834043](https://gitee.com/ephtiny/image/raw/master/img/202304212218140.png)

k输入的与非门由k个串联的nMOS管和k个并联的pMOS管构成，只有三个输入均为1时，输出才会通过串联的nMOS管下拉至低电平



### 1.4.3 CMOS逻辑门

​	反相器和与非门是静态CMOS逻辑门(static CMOS logic gate)也称互补CMOS门(complementary CMOS gate)的两个例子

![image-20230421222847334](https://gitee.com/ephtiny/image/raw/master/img/202304212228412.png)

​	静态CMOS门中的这两个网络被设计成对于任何一种输入图案，其中必有一个网络导通，而另一个关断。当没有这个设计时会有如下的输出状态表

![image-20230421224126489](https://gitee.com/ephtiny/image/raw/master/img/202304212241561.png)

- Z：当上拉和下拉都关断时会形成高阻(high impedance)，即浮空(floating)的输出状态Z。这在多路开关、存储单元及三态总线驱动器中很有意义
- X：当上拉而和下拉同事导通时就形成竞争(contention)电平，急用叉号(crowbar)表示的电平X。此时这连个网络之间的竞争将产生一个不确定的输出电平并引起静态功耗，这是我们不希望出现的情况



​	反相器中的上拉和下拉网络每个都只含一个晶体管，与非门采用一个晶体管串联的下拉网络和一个晶体管斌两的上拉网络

​	两个或多个晶体管的串联组合只有当所有串联的晶体管都导通时才导通，两个或多个晶体管的并联组合只要其中任何一个并联的晶体管导通就能导通。下面是一对nMOS管和pMOS管串并联时的情形，利用这些结构的组合可以构造出许多种CMOS组合门

![image-20230421223907720](https://gitee.com/ephtiny/image/raw/master/img/202304212239812.png)



### 1.4.4 或非(NOR)门

![image-20230421224644605](https://gitee.com/ephtiny/image/raw/master/img/202304212246691.png)

​	对于三输入或非门，当任何一个输入为高时，输出通过并联的nMOS管下拉至低电平。当所有输入为低时，输出通过串联的pMOS管上拉至高电平



### 1.4.5 复合门(compound gate)

![image-20230421225543323](https://gitee.com/ephtiny/image/raw/master/img/202304212255417.png)



​	实现一对二输入“与”的“或非”功能 常被称为与-或-非-22或AOI22。

​	图1.18中的a、b相对容易理解，“与”的表达式可以通过串联实现。接下来将“或”拆分为两部分，一个为a中两组一组导通则下拉，因此a中两组并联且置于下方，也就是nMOS下拉网络

​	对于pMOS上拉网络，我们必须计算与nMOS网络互补的表达式，它所采用的开关管在极性相反的输入时导通。根据德摩根定理，这相当于将一个网络中的“与”（“或”）操作与另一个网络中的“或”（“与”）操作互换。因此与下拉网络中串联nMOS管相对应的上拉网络中的pMOS管必须并联，而与下拉网络中并联nMOS管相对应的上拉网络中的pMOS管必须串联。

​	上面是书本原话，下面是我对这个的理解（这里的理解可能会存在问题，如果能看懂原文的意思那下面就不用看了）：

- 对表达式与图的分析：由于b是下拉网络，则d是上拉网络。通过表达式可知，需要(A·B)与(C·D)都要为0才能上拉（pMOS管是输入为0时导通），即A与B、C与D这两组都至少有一个是0，AB并联可以实现AB间有一个0就可导通，CD并联一样，之后二者串联
- 对原文的理解：根据我的观察，我发现nMOS负责下拉，pMOS负责上拉。对于pMOS上拉网络，计算nMOS网络互补的表达式则下拉网络中串联的变并联，并联的变串联。pMOS上拉网络所采用的开关管在极性相反的输入时导通，这里的极性相反应该不是指输入的数值相反，而应该是最终效果相反。

​	

​	当使$$C=\overline{A}$$并作为选择信号时，这个AOI22门可以用来作为一个二输入的反相多路开关，即若C=0时，Y=$$\overline{B}$$，而C为1时，Y=$$\overline{D}$$



![image-20230421235645374](https://gitee.com/ephtiny/image/raw/master/img/202304212356445.png)

​		图1.19为 或-与-非-3-1（即OAI31）门。当D为1且ABC中任何一个为1时，nMOS下拉网络将时输出下拉为低电平，所以D和A、B及C的并联组合串联在一起。由于pMOS上拉网络是nMOS下拉网络的“互补导通”，所以在pMOS上拉网络中D必须和A、B及C的串联组合并联



### 1.4.6 传输管(Pass Transistor)和传输门(Transmission Gate)

​	一个信号的强度(strength)是以它与理想电压源的接近程度来度量的。一般来说，信号越强它所能提供或吸收的电流就越多。	

​	电源电压V~DD~和GND各为最强的1和0信号源，又称轨线(rail)电压

![image-20230422151015984](https://gitee.com/ephtiny/image/raw/master/img/202304221510065.png)

​	nMOS管在传送0时是一个近乎理想的开关，因此说能传送“强0”；而传送1时不理想，得到的高电压比V~DD~要低些。pMOS管则相反。输入驱动下拉网络中nMOS只需传送0，而互补上拉网络中pMOS只需传送1，输出总是被强驱动，因而输出电平永远不会变弱，这样的门被称为“全复原”(full restored)逻辑门，能大大简化电路设计

![image-20230422151810719](https://gitee.com/ephtiny/image/raw/master/img/202304221518822.png)

- 传输管：nMOS或pMOS单独作用作为一个非理想开关
- 传输门/传送门：将nMOS与pMOS并联、

​	在图1.21(c)中，无论0还是1都能被这个开关以一种可以接受的方式传送出去

​	静态CMOS门总能正确工作而与晶体管的实际尺寸无关，且对于任何输入组合，“1”和“0”之间不会有通过晶体管使它们直接导通的路径，这也是CMOS中静态功耗很低的主要原因

​	不能直接将反相器的上下拉管互换来构成非反相门，这样会产生减弱的输出

![image-20230422153408295](https://gitee.com/ephtiny/image/raw/master/img/202304221534406.png)

​	复合门也可以也可以用两个与门、一个或门和一个反相器构成，而与门和或门又可以用与非/或非门及反相器构成，但这里总共需要20个晶体管

![image-20230422153637483](https://gitee.com/ephtiny/image/raw/master/img/202304221536559.png)

### 1.4.7 三态门

![image-20230422153821179](https://gitee.com/ephtiny/image/raw/master/img/202304221538250.png)

​	当EN为1时，三态缓冲器的作用就像一个普通的缓冲器

​	图1.26的传输门与图1.25的三态缓冲期真值表相同

![image-20230422154228860](https://gitee.com/ephtiny/image/raw/master/img/202304221542929.png)

​	EN为0时，输出浮空；EN为1时可当作反相器

​	d是三态反相器的符号。一个普通反相器之后接一个三态反相器可以构成一个三态缓冲器

​	三态总线会存在一些问题，现在设计者优先采用多路开关

### 1.4.8 多路开关(Multiplexer)

![image-20230422172108206](https://gitee.com/ephtiny/image/raw/master/img/202304222044517.png)

逻辑函数：Y = $$\overline{S}$$ · D0 + S · D1

![image-20230422173234312](https://gitee.com/ephtiny/image/raw/master/img/202304222044524.png)

​	我们可用逻辑门构成复原的反相多路开关。。一种方式是将图1.18(e)中的复合门连成如图1.29(a)那样;另一种方式是将两个三态反相器连接起来，如图1.29(b)所示。这两种方式构成的电路图儿平完全相同，只是重新排布了一下（因为它的选择信号及其反信号是相互排斥的）

​	三态反相器的方式稍微简单一些并且速度也较快些，因为它需要的内部连线较少。如果反相选择信号时在单元内部产生，那么可以把它从符号图中略去

​	较大的多路开关可以用多个二输人多路开关构成或直接把几个三态反相器组合在一起构成。采用后一种方式时，每个三态反相器需要有一个译码使能信号，这些使能信号应当同时翻转以防止竞争。

​	反相和非反相多路开关都简称为多路开关或MUX。

### 1.4.9 时序电路(Sequential Circuit)

​	组合电路的输出仅取决于当前的输入；而时序电路的输出同时取决于当前和之前的输入。

​	如锁存器(latch)、触发器(flip-flop)这样的时序电路会接受一个时钟输入CLK和一个数据输入D，并产生一个输出Q。

- 一个D锁存器在CLK=1时透明(transparent)，即Q跟随D而改变;它在CLK=0时不透明(opaque)，即不管D如何变化, 仍保持它原来的值。	
- 一个沿触发的触发器(edge-triggered fip-flop)只在CLK的上升沿时将D复制到Q，而在其他时间均保持它原来的值不变。

#### 1.4.9.1 锁存器(Latch)

![image-20230423151013358](https://gitee.com/ephtiny/image/raw/master/img/202304231510515.png)

​	上图所示的锁存器为正电平灵敏锁存器，当使它的多路开关的控制连线反相位时，就变成了负电平灵敏锁存器

​	D锁存器也称为电平灵敏锁存器(Level-sensitive latch)，这是因为它的输出状态取决于时钟信号的电平

#### 1.4.9.2 触发器(Flip-Flop)

​	当将一个负电平灵敏和一个正电平灵敏连在一起时，就能构成边沿触发的触发器。第一级锁存器称为主锁存器(master)，而第二级称为从锁存器(slave)

![image-20230423155016911](https://gitee.com/ephtiny/image/raw/master/img/202304231550985.png)

​	当CLK 为低时，负电平灵敏主锁存器的输出(OM)跟随输入D而变化，此时正电平灵敏的从锁存器保持它原来的值(见图 (c))。当时钟从0 跳变到1时，主锁存器变为不透明并保持在时钟跳变时的D值，而从锁存器变为透明，将主锁存器所保存的值(QM)传送至从锁存器的输出(Q)。由于此时主锁存器已与输人D断开(见图(d))，因而输人D被阻止而不会影响输出。当时钟从1跳变至0时，从锁存器保持它的值而主锁存器开始再次采样输入数据。

![image-20230423155035550](https://gitee.com/ephtiny/image/raw/master/img/202304231550619.png)

​	一个好的设计会如(e)那样增加反相器来缓冲输入和输出，使它保持我们称之为“模块化”(modularity)的特性

​	这一触发器在时钟的上升沿时将 D复制到 Q，因此这一器件称为正沿触发的触发器(positive-edge triggered flip-lop)，也称为D触发器(D ip-flop)D 寄存器(Dregister)或主从触发器(master-slave flip-flop)

​	当使它的两个锁存器的极性都相反时就可以构成一个负沿触发的触发器

​	共享公共时钟输入的多个 D触发器的集合称为寄存器(register)。寄存器常常画成具有多位 D和Q总线的触发器。

​	如果系统的时钟偏斜(clock skew)太大，即由于时钟到达时间的不同使一个触发器触发得早些而另一个触发器触发得晚些，那么触发器就有可能发生保持时间(hold-time)失效。

![image-20230423161524045](https://gitee.com/ephtiny/image/raw/master/img/202304231615118.png)

​	可以采用两相位不重叠时钟的时序控制来完全避免保持时间问题。图1.33 为用两相不重叠时钟控制的触发器。只要两个相位在任何情况下都不重叠，那么无论何时至少有一个锁存器不透明，因而绝不会发生保持时间问题。

## 1.5 CMOS的制造和版图

​	晶体管制造在很薄的硅圆片(silicon waer)上，硅圆片用来作为机械支撑又用来作为电气上的公共节点，即所谓的衬底(substrate)。

​	在考察晶体管的物理版图时，我们先看一个完整 CMOS 反相器的横截面图，然后看它的顶视图并定义一组用来制造该反相器不同部分的掩模。晶体管和导线的尺寸由掩模的尺寸确定并受制造工艺分辨率的限制。

### 1.5.1 反相器的横截面图

![image-20230423162025597](https://gitee.com/ephtiny/image/raw/master/img/202304231620676.png)

​	nMOS 晶体管包含重掺杂的n型源区和漏区以及在二氧化硅(SiO)薄层(也称为栅氧，即gate oxide)上的多晶硅栅。n^+^和p^+^扩散区是指重掺杂的n型和p型硅。

​	两个晶体管的多晶硅栅在某处连在一起(图中未画出)形成输入A。

​	两个晶体管的漏用金属线连在一起形成输出 Y。

​	除了明确刻蚀了接触孔的位置而外，在金属层与其他层之间还有一层称为场氧(feld oxide)的厚二氧化硅(SiO层用来防止金属与其他层之间发生短路。



​	金属与轻掺杂半导体之间的结形成了只能沿一个方向传送电流的肖特基二极管(Schotky di-ode)。当半导体掺杂较重时，它与金属间形成良好的欧姆接触，因而对双向电流都呈现低阻。衬底必须连至低电位以避免p 型衬底和 nMOS 的n^+^源或漏之间的p-n 结发生正向偏置。同样，n阱必须连至高电位。通过增加重掺杂的衬底接触和阱接触(或称接头，即 tap)，可以将 GND(低电位)和 V~DD~(高电位)分别连至村底和n阱。



### 1.5.2 制造工艺

​	假定反相器由六层掩膜定义：n阱、多晶硅、n^+^扩散、p^+^扩散、接触和金属，实际掩膜组往往更复杂

![image-20230423162049049](https://gitee.com/ephtiny/image/raw/master/img/202304231620141.png)

![image-20230423162110242](https://gitee.com/ephtiny/image/raw/master/img/202304231621318.png)

- 制造过程从在一块p型硅的裸圆片上制作n阱开始。

![image-20230423212300600](https://gitee.com/ephtiny/image/raw/master/img/202304232123752.png)

​		加入掺杂剂有两种方法即扩散和离子注人。

- 接下来制作晶体管的栅，并为晶体管的有源区和阱接触形成n^+^区

![image-20230423215639228](https://gitee.com/ephtiny/image/raw/master/img/202304232156343.png)

​		多晶硅需要进行重掺杂，使它变成一种良好的导体

​		n^+^区通常是用离子注人的方法形成的，但它们在历史上曾经用扩散的方法，因而仍常称它们为n扩散区(n-diffusion)。在nMOS管上的多晶硅栅阻挡了扩散，因此源和漏被栅下的沟道隔开。这一工艺称为自对准工艺(self-aligned),因为晶体管的源和漏自动形成在邻近栅的两侧而不需要精确地对准掩模。

- 然后进行p扩散、使圆片与金属层之间绝缘需要生长场氧、将金属铝溅射在整个圆片上并填充接触孔

![image-20230423215652999](https://gitee.com/ephtiny/image/raw/master/img/202304232156088.png)

​		生长场氧时，需要用接触掩模形成图案(见图1.35(f)),以在金属应当与扩散或多晶硅相连的地方留出接 触孔(contact cut)(见图1.38(b))。

### 1.5.3 版图设计规则

​	版图设计规则说明了一个具体制造工艺能可靠密集制造的特征线条所允许的精细程度以及它们相互间允许的接近程度。工业界的设计规则常常以微米为单位来规定。

​	大学里常常采用可伸缩的设计规则来简化设计，这些设计规则比较保守，足以适用于许多种制 造工艺。Mead和Conway[Mead80]基于单个参数λ来表征工艺的分辨率，由此推广了可伸缩的设计 规则。λ一般是指所能设计的晶体管最小沟道长度的一半。沟道长度是晶体管源和漏之间的距离， 它由多晶硅线条的最小宽度确定。

​	λ规则比较简单和易 于按比例缩小，但它牺牲了基于微米的规则可能带来的格度优势。由于设计者经常用特征尺寸( fenture size)描述一种工艺，而特征尺寸是指晶体管的最小沟道长度，因此λ就是特征尺寸的一半。

​	180nm以下时，设计规则已变得非常复杂并且与具体的工艺有关，这使按比例伸 缩的设计规则很难应用。

![image-20230423222903068](https://gitee.com/ephtiny/image/raw/master/img/202304232229166.png)

![image-20230423222930651](https://gitee.com/ephtiny/image/raw/master/img/202304232229747.png)

​	在三层金属工艺中，第三层金属的宽度一般为6λ而间距为4λ。一般来说，在具有较多金属 层的工艺中，顶层金属线常常较厚、较宽因而具有较低的电阻。

​	晶体管的尺寸通常用它们的宽度/长度比(W/L)说明。带接触的最小宽度晶体管常常称为单位晶体管。

​	pMOS管往往 比nMOS管宽，因为空穴比电子移动得慢，因而pMOS管必须宽些才能传送相同的电流。

![image-20230423224040510](https://gitee.com/ephtiny/image/raw/master/img/202304232240585.png)

​	(a)为一个单位反相器的版图，它包含一个单位nMOS管和一个两倍尺寸的pMOS管。(b)为这个反相器的电路图，图中标注了每个晶体管的宽度/长度比。(c)为本书中常用的晶体管尺寸简咯表示方法，它假设采用最小的沟道长度而只表示出宽度是单位宽度的多少倍。

​	在数字系统中，晶体管一般都设计成具有尽可能小的沟道长度，因为沟道较短的晶体管较快、尺寸较小并且功耗也较低。

### 1.5.4 门级版图

​	这种简单的版图风格基于“扩散线”(line of diffusion)规则，常在自动版图系统中用来设计标准单元。

​	这一版图风格由 4行水平线条构成：单元底部的金属接地线、n扩散区、 p扩散区以及单元顶部的金属电源线。

![image-20230423224452766](https://gitee.com/ephtiny/image/raw/master/img/202304232244871.png)

​	可以用多晶硅线从顶部、底部或左侧连接到输人A。 输出Y可以用金属线从该单元的右侧引出。p衬底和n阱必须分别连至地和电源。



- nMOS的串联方式：
- pMOS的并联方式：

​	==电源和地线在左右两边都延长了2λ,这样如果两个门邻接起来的话，它们之间就将相隔4λ==,恰好满足设计规则。该单元的高度为36λ,但如果==考虑在这个单元和它上面的另一 条导线之间还应当有4λ的间距==时，它就是40λ

​	在现时的标准单元中，多晶硅一般不用来作为布线层，单元通过金属2至金属I以及金属1至多晶硅的接触连到每个栅上。这样做虽然会增大单元的尺寸，但它却能在金属布线层上自由连接到所有的端口上。

### 1.5.5 棒图

​	设计者在着手画完整的版图前需要有布置单元和预估面积的快速方法。棒图(stick diagram)是一种很容易画的图，因为它不需要按比例画。

![image-20230423233401266](https://gitee.com/ephtiny/image/raw/master/img/202304232334349.png)

​	版图的面积通常由金属导线决定

​	我们定义==布线通道(routing track)==为能布置一条导线并能满足它与相邻导线间的间距要求的足够空间。例如，如果导线宽度为4λ,它与相邻导线间的间距要求也是4λ,那么布线通道的节距(pitch)即中心距就是8λ,如图1.44(a)所示。这一节距也已足够在两条导线之间布 置一个晶体管(见图1.44(b))。因此，==通过统计金属布线通道的数目并将它乘以8λ来预估一个单元的高度和宽度==是很合理的

![image-20230423233948086](https://gitee.com/ephtiny/image/raw/master/img/202304232339212.png)

​	由于有阱的原因，在nMOS和pMOS管之 间要求有12λ的间距，即在nMOS和pMOS管之间必须多分配一条额外的导线通道而不管实际上是否有导线使用它



​	图1.46中有四条垂直方向的导线通道（按我的理解是如图1.44的为导线通道，即头带黑框的），乘以每通道8λ的节距就可知单元宽度为32λ;而由五条水平方向的通道（这里没有按比例画）就可知单元高度为40λ。

![image-20230423234014980](https://gitee.com/ephtiny/image/raw/master/img/202304232340082.png)

## 1.6 设计划分(Design Partitioning)

​	现代VLSI设计中最大的挑战在于如何处理系统的复杂性

​	设计任务会划分给多个工程师团队。此时任务划分会出现两个极端：如果划分得太严格，那么每个功能块在进行优化时就可能没有考虑到其相邻功能块的情况，从而导致最终的系统性能很姜。相反，如果每项任务都和其他任务相互依赖，那么设计就将进展太慢

​	设计过程将经过多个抽象层 次，这些层次隐去了许多设计细节直到必须用到它们时才出现。实际中都采用结构化的设计方 法(structured design),这一方法也用在大的软件开发项目中。它利用层次化(hierarchy)、规整化 (regularity)、模块化(modularity)和局域化(localiy)的原理来驾驭系统的复杂性。

### 1.6.1 设计抽象(Design Abstraction)

​	数字VLSI设计常常划分成五个抽象层次：体系结构(architectue)设计、微结构(microarchiteeture)设计、逻辑(logic)设计、电路(circuit)设计和物理(physical)设计

- 体系结构描述系统的功能
- 微结构描述体系结构如何划分成寄存器和功能部件
- 逻辑设计描述如何构成功能部件
- 电路设计描述如何用晶体管实现逻辑
- 物理设计描述芯片的版图

​	这些设计要素有内在的相关性，它们都会影响每一个设计目标。为了解决这些相互依赖的问题，微结构、逻辑、电路和物理设计必须并行进行，或至少一部分应当如此。

### 1.6.2 结构化设计

​	层次化(hierarchy)是处理复杂设计的关键手段。一个大系统可以分层次地划分成几个核 (core),每个核由各种部件(unit)构成，每个部件又由多个功能块(functional block)构成。这些功能块再由单元(cell)组成，单元最终由晶体管实现。可以把设计层次看成是一种树结构，即整块芯片是根(root)而基本单元是叶(leaf)。

​	规整化(regularity)通过尽可能设计种类数目最少的不同功能块来降低设计的复杂性。

​	模块化(madularity)要求每个功能块都有确切定义的接口以避免未预想到的相互影响。

​	域化(locality)是指将信息保持在使用它的物理位置和时间段上。

### 1.6.3 行为、结构和物理设计域

![image-20230425162403644](https://gitee.com/ephtiny/image/raw/master/img/202304251624806.png)

​	上面三个设计域可以用来描述几乎所有的人工产品设计，因而是通常描述设计过程的分类方法。

- 行为域描述一个具体系统完成什么任务。
- 结构域描述为实现一个具体的行为需要怎样将各个模块互连在一起。
- 物理域描述说明如何在实际上(物理上)实现这一抽象层次。

​	可以将设计过程看成是完成从一个设计域转换到另一个设计域但仍保持各个域之间等价性的过程。通常在实际设计中都需要对一个域到另一个域的转换进行验证。

​	Y图可以用来说明每个设计域以及在各个设计抽象层次上设计域之间的转换。当设计过程从外圈逐渐绕到里圈时，它就从较高的抽象层次和等级过渡到较低的抽象层次和等级。

## 1.7 举例：一个简单的MIPS微处理器

​	下面将描述MIPS的体系结构以及将要实现的多周期微结构。若不熟悉计算机体系结构，可以将MLPS处理器看成是一个黑盒子，直接看1.8节

### 1.7.1 MIP体系结构

​	这个体系 结构子集采用32位指令编码但只有八个8位的通用寄存器($0~$7)。另外还有一个8位的程序 计数器(Program Counter,PC)。寄存器0通过硬布线使它的各位都含数字0。指令有ADD(加)、 SUB(减)、AND(按位与)、OR(按位或)、SLT(小于时置1)、ADDI(立即数加)、BEQ(相等时转移)、 J(跳转)、LB(取字节)和SB(存字节)。

![image-20230425165605453](https://gitee.com/ephtiny/image/raw/master/img/202304251656547.png)

![image-20230425165642261](https://gitee.com/ephtiny/image/raw/master/img/202304251656313.png)

​	我们可以用汇编语言(assembly language)为MIPS处理器编程，不过一般用高级语言(high-level language)如C或Java编程。编译器(compiler)将一个程序从高级语言的源代 码(source code)转换成合适的机器语言的目标码(object code)。

![image-20230425170250463](https://gitee.com/ephtiny/image/raw/master/img/202304251702536.png)

![image-20230425170259462](https://gitee.com/ephtiny/image/raw/master/img/202304251702524.png)

![image-20230425170310242](https://gitee.com/ephtiny/image/raw/master/img/202304251707833.png)

![image-20230425170322899](https://gitee.com/ephtiny/image/raw/master/img/202304251703956.png)

### 1.7.2 多周期MIPS微结构



## 1.8 逻辑设计

​	我们从定义顶层的芯片接口和方块图开始逻辑设计，然后逐层分解部件直至得到叶子单元。我们利用硬件描述语言(Hardware Description Language,HDL)来描述逻辑。这一描述代码常称为寄存器传输级(Register Transfer Level,RTL) 描述。

### 1.8.1 顶层接口

![image-20230425170548085](https://gitee.com/ephtiny/image/raw/master/img/202304251705143.png)

​	这里采用两相位时钟系统以避免保持时间(hold-time)问题。复位(Reset)信号使PC初始化为0因而控制FSM回到起始状态。

![image-20230425170621703](https://gitee.com/ephtiny/image/raw/master/img/202304251706763.png)

​	处理器送出8位的地址Adr并根据要求决定是否将Merwrite置为有效。在读周期时，存储器将送出一个值并放到MemData线上，而在写周期时，存储器将接受来自WriteData线上的输入。

​	在许多系统中，MemData和WriteData可以合成为一条双向总线，但在本例中我们仍 保留图1.53中的接口。

### 1.8.2 方块图

![image-20230425172644635](https://gitee.com/ephtiny/image/raw/master/img/202304251727384.png)

- 控制器包括控制 FSM、ALU译码器和两个用来产生PCEn信号的逻辑门。
- ALU译码器由组合逻辑构成用来产生 ALUContmol信号。
- 芯片的其余部分为8位的数据通路。可以把它看成是字片(wordslice)或位片(bitslice)的集合。字片含一列8位的触发器、加法器、多路开关或其他元件

![image-20230425172724510](https://gitee.com/ephtiny/image/raw/master/img/202304251727585.png)

​	它含有8个独立的一位2:1多路开关，以及一个由缓冲器和反相器 构成的拉链电路(zipper)用来驱动所有这8个多路开关的正反选择信号。

​	这种不在各个多路开关中设置反相器而是把这些驱动器提取出来集中用一个拉链电路驱动的方式可以节省许多空间。

​	我们可以把数据通路看成是8行位片。每个位片含各个组件中的-·位以及将这些位连 在一起的水平导线。



​	芯片划分受物理设计规划的影响。数据通路含大部分的晶体管并凡结构非常规整。通过==手工设计每一字片或位片然后把这些电路像瓦片那样铺在一起==可以使我们花费不多的功夫就能达到很高的密度。==通常利用字片构成数据通路==比较容易，因为某些结构如ALU中判“O”(判断是否为零)的电路在各个位片中并不相同。但是考虑位片形式对于规划穿越数据通路的布线很有帮助。控制器的结构性要差得多。用手工将FSM转换成逻辑门非常麻烦，而且在一个新的设计中，控制器是最有可能出现故障的部分并且常常到设计的最后阶段还要修改。因此，我们将==用硬件描述语言较为抽象地描述控制器，并用综合(synthesis) 和布局布线(place&route)工具或可编程逻辑阵列(Programmable Logic Array,PLA)自动生成它==。

### 1.8.3 设计层次

![image-20230425215418450](https://gitee.com/ephtiny/image/raw/master/img/202304252154530.png)

​	在逻辑、电路和物理设计中的设计层次不一定需要完全相同。例如，从邃辑角度看，最好将存储器看成是一个黑匣子，而在电路实现时，它可以划分成译码器、存储单元阵列、列多路开关等。但设计层次各不相同将使验证复杂化，因为它们必须被展平(flartened)直到它们都一致为止。因此实际设计时，最好使逻辑、电路和物理的设计层次尽可能一致。

### 1.8.4 硬件描述语言

​	在将方块图和FSM的状态转移图转换成电路原理图之前最好先确认一下顶层设计是否存在需要我们完全重新设计的严重错误。硬件描述语言(HDL)提供了一种在较高抽象层次上描述设计的方法，它能提高设计者的设计效率。

​	当前两种最流行的HDL是Verilog和VHDL。Verilog比较简明并接近C语言的句法，而VHDL支持对大团队项目很有用的某些抽象功能。无论哪一种语言都没有对另一种语言的绝对优势，所以工业界不得不同时支持这两种语言

​	当用HDL编码时，应当注意你是在描述==并行操作的硬件==而不是顺序执行的软件。有两种一般的编码方式：结构级(structural)HDL描述一个单元如何由其他单元或基本逻辑门及晶体管组成，而行为级(behaviaral)HDL描述这个单元做什么。

​	==逻辑模拟器(logic simulator)用来模拟HDL代码==，它能报告模拟结果是否与期望结果相符，并能显示波形以帮助查找出现差别的原因。逻辑综合(logic synthesis)工具类似于一个硬件编译器：它将HDL代码映射到一组称为标准单元(standard cell)的逻辑门库(library)上，使面积尽可能小且能满足某些时序约束(timing constraint)。但只有部分HDL结构是可综合的，本书附录将重点列出这一子集。

​	由逻辑综合生成的电路一般总不如由经验丰富的设计者手工完成的电路面积小和速度快。但集成电路工艺现在已很先进，因此综合生成的电路对于今天所需的绝大多数专用集成电路(Application-Specitic Integrated Circuit,ASIC)来讲已足够好，它们的版图可以用布局布线工具自动生成。



​	附录A.12列出了MIPS处理器的Verilog和VHDL模型。在Verilog中，每个单元称为模块(module)。它的输入/输出说明与C程序中的说明非常类似，其中总线是用位宽(bit width)来表示的。内部信号也必须用与局部变量相类似的方式表示。这一处理器在==顶层上用结构级Verilog分层次地描述==，而对==叶子单元采用行为级Verilog描述==。

​	例如，控制器模块显示了如何用行为级Verilog描述有限状态机而aludec模块显示了如何描述复杂的组合逻辑。数据通路用字片(wordslice)进行结构级描述，而字片再进行行为级描述。

![image-20230425224743209](https://gitee.com/ephtiny/image/raw/master/img/202304252247287.png)

​	我们可以把一个8位的加法器字片在结构上描述成由8个全加器串联起来组成的一个串行进位加法器。全加器可以在结构上表示成一个求和(sum)子电路和一个进位(cary)子电路。求和及进位子电路又可以用行为级来描述

![image-20230425224907052](https://gitee.com/ephtiny/image/raw/master/img/202304252249129.png)

## 1.9 电路设计

​	电路设计涉及安排晶体管去执行一个具体的逻辑功能。有了电路设计就可以估计出它的延时和功耗。电路可以表示成电路原理图，或用文本方式表示成网表(netlist)。常用的晶体管级网表格式包括Verilog和SPICE。Verilog网表用于功能验证，而SPICE网表含进行延时和功耗模拟所必需的更多细节。



​	由于晶体管栅是良绝缘体，所以可以把它建模成一个电容C。当晶体管导通时，在它的源和漏之间就会有某个电流I流动。这一电流和电容的大小都与晶体管的宽度成正比。

![image-20230425225458021](https://gitee.com/ephtiny/image/raw/master/img/202304252254079.png)

​	一个逻辑门的延时由它能提供的电流及它所驱动的电容决定，如图1.60中一个反相器驱动另一个反相器的情形所示。==电容的充电和放电由以下基本方程决定：$I = C\frac{dV}{dt}$==

​	如果考虑==I为平均电流==，那么==使电压在0和Vo之间翻转的时间t为：$t = \frac CIV_{DD}$==,因此延时随负载电容增加而增大，随驱动电流增加而减小。

​	充电和放电负载电容都需要能量，这称为动态功耗(dynamic power),因为它是在电路快速翻 转过程中消耗的功耗。当一个电容以频率f充放电时，它所消耗的==动态功耗为：$P_{dynamic} = CV^2_{DD}f$==

​	即使在逻辑门不翻转时，它也消耗一定的静态功耗(static power)。这是因为一个关断的晶体管总 是有泄漏的，即总会有一个小电流      l~static~在电源和地之间流动，从而引起==静态功耗：$P_{static} = I_{static}V_{DD}$==



​	在许多设计方法学中，逻辑综合工具能寻找能最佳实现电路的标准单元。但当一个系统对高速度和低功耗有特殊要求或将大批量生产因而值得花费额外的工程代价时，对该芯片的关键部分采用定制电路设计就显得十分重要。

![image-20230426133329528](https://gitee.com/ephtiny/image/raw/master/img/202304261333663.png)

​	图1.61为全加器中进位电路的两种不同的电路设计。图1.61(a)中的门级设计共需要26个晶体管和4级门延时(如前所述，与门和或门由与非门和或非门在后面接反相器构成)。而图1.61(b)中的晶体管级设计只需要12个晶体管和两级门延时，这表明了利用CMOS工艺的优点优化电路设计时所能带来的好处。

- 门级设计生成的网表

![image-20230426134019401](https://gitee.com/ephtiny/image/raw/master/img/202304261340485.png)

- 晶体管级网表

![image-20230426134127325](https://gitee.com/ephtiny/image/raw/master/img/202304261341395.png)

晶体管的表示方式如下：

​	晶体管类型名称(漏，源，栅); 

​	tranifl代表栅电压为1时导通的nMOS晶体管，而tranif0代表栅电压为0时导通的pMOS晶体管。



​	至此还未决定逻辑门速度或功耗所需的信息，还需要说明晶体管的尺寸和寄生电容。这时候需要使用SPICE电路模拟器所使用的结构语言。例如，晶体管级进位子电路的电路级描述可以表示如下：

![](https://gitee.com/ephtiny/image/raw/master/img/202304261352186.png)![image-20230426135146424](https://gitee.com/ephtiny/image/raw/master/img/202304261351522.png)

​	其中晶体管按行说明，说明行以字母M开头：

![image-20230426135305279](https://gitee.com/ephtiny/image/raw/master/img/202304261353333.png)

​	MOS开关实际上是四端口器件，其中衬底或阱形成体端(hody terminal)。虽然Verilog中不列出体的连接，但在SPICE中必须有它。类型(type)用来说明晶体管是p型器件还是n型器件，而宽度(width)、长度(length)和面积参数说明实际晶体管的物理尺寸。它们的单位包括U(micmo表示“微”,即10^-6^)、P(pico表示“皮”,即10^-12^)和F(femto表示“飞”,即10^-15^)。

​	电容也按行说明，但以字母C开头：

![image-20230426135110217](https://gitee.com/ephtiny/image/raw/master/img/202304261351270.png)



​	在以上子电路的描述中，SPICE中的MOS模型根据所说明的器件尺寸计算出MOS晶体管中固有的寄生电容。而在以上描述中额外的电容语句用来表示非器件结构本身固有的附加布线电容，它的大小取决于逻辑门的物理设计。

​	此外，较长的导线也表现出较大的电阻，这将使延时加大。在电路级的结构描述中列出了所有的连线，它们对于完整表征进位门的速度，功耗和连接关系是必不可少的。

## 1.10 物理设计

### 1.10.1 平面规划

物理设计首先从平面规划(floorplan)开始

用处：估计芯片中主要部件的面积并定义它 们间的相对位置

重要性：决定所提出的设计方案是否能满足芯片面积的预算要求 并能估计出布线长度和布线的拥挤程度。

难点：需要在着手进行芯片的细节设计(它取决于平面规划和布线长度)之前预先估计出每个部件的尺寸

​	平面规划中常常会提出修改逻辑(和微结构),但这些修改又反过来会要求调整平面规划。

![](https://gitee.com/ephtiny/image/raw/master/img/202304261412696.png)

​	顶层功能块是控制器和数据通路。布线通道位于这两个功能块之间以提供空间把控制信号布线到数据通路。数据通路进 一步划分成字片。焊盘框(pad frame)包含40个I/O焊盘，它们用导线连接到芯片封装的引脚 (pin)上。其中29个焊盘用于信号，其余为V~DD~和GND。

![image-20230426142125560](https://gitee.com/ephtiny/image/raw/master/img/202304261421638.png)

![image-20230427210618050](https://gitee.com/ephtiny/image/raw/master/img/202304272106305.png)

​	紧邻焊盘框内侧的是金属层2 (metal2)的V~DD~和GND环，分别标注了“+”和“-”。

​	片上的结构可以分类为随机逻辑(random logic)、数据通路(datapath)、阵列(aray)、模拟电路(analog)以及输入/输出(input/output)即I/O

- 随机逻辑如aludecoder(ALU译码器),几乎没有什么规则的结构
- 数据通路对多位数据字进行操作但对每位几乎执行相同的功能，所以它们由多个N位的字片构成
- 阵列结构如RAM、ROM和PLA,由在二维方向上重复出现的相同的单元构成

​	随机逻辑和数据通路一般都用标准单元( standard cell)如反相器、与非门和触发器等构成。

​	MIPS平面规划采用水平走向的金属1(metall)导线、垂直走向的金属2(metal2)导线以及水平走向的金属3(metal3)导线。在每两层间交替走向能够很容易地通过不同的布线层横跨导线。

### 1.10.2 标准单元

​	电源和地线是水平走向的金属1。衬底和阱的接触布置在电源轨线的下面。输入和输出由垂直走向的金属2提供。

![image-20230427212724447](https://gitee.com/ephtiny/image/raw/master/img/202304272127548.png)

​	这是用自动布局布线 (place&route)工具生成。

​	在有两层金属的工艺中，水平走向的金属1导线布置在行之间的布线通道(routing channel)内。当有更多的金属层可用时，由于可以在单元上方布线，所以也许就不再需要布线通道了。

![image-20230427213007774](https://gitee.com/ephtiny/image/raw/master/img/202304272130900.png)

​	图1.65为整个8位MIPS处理器的版图，它由附录A.I2中的VHDL模型采用130nm七层金属工艺的单元库综合而成。

​	由综合得到的设计往往比一个好的定 制设计速度慢些，但设计它们所花费的努力也要少一个数量级。

### 1.10.3 节距匹配

​	通过把导线包含在“咬接”(snap together)单元内可以提高版图的密集度。咬接单元的设计和版图绘制需要花费较大的努力，但它能减小面积和缩短导线长度(因而速度更快)。

​	设计咬接单元的关键是节距匹配(pitch-matching),相连的单元必须沿连接边有相同的尺寸，下面是咬接单元的例子

![image-20230427214138453](https://gitee.com/ephtiny/image/raw/master/img/202304272141530.png)

![image-20230427214155698](https://gitee.com/ephtiny/image/raw/master/img/202304272141858.png)

​	这是MIPS数据通路的细节。版图顶部包括三行拉链电路用来驱动译码器，译码器的节距与数据通路中寄存器堆的节距相匹配。垂直方向的金属2导线用于控制，包括时钟、多路开关选择和寄存器使能信号。水平方向的金属3导线在单元上方布线，它们沿位片传送数据。

### 1.10.4 分片规划

![image-20230427214702031](https://gitee.com/ephtiny/image/raw/master/img/202304272147128.png)

​	上图显示了字片的拌列顺序以及在每一个位片内导线通道的分配情况。圆点表示有一条总线在单元上方通过并且也用于该单元。每一单元都标注了它的类型和宽度(用通道数目表示)。

​	分片规划对估计数据通路的面积很重要，每个字片都标注了用通道(track)数表示的宽度。

### 1.10.5 阵列

![image-20230427215337276](https://gitee.com/ephtiny/image/raw/master/img/202304272153404.png)

​	PLA可以计算用“积之和”(sum of products)形式表示的任何逻辑函数。

​	在这个PLA版图中，每个输入使用两条垂直通道，每个输出使用三条垂直通道，再加上6条 垂直通道用于其他开销，每个“积项”即“小项”(minterm)使用1.5条水平通道，再加上14条水平通道用于其他开销，这样可以计算出PLA的尺寸。其总面积为500λ×350λ再加上另外的336λ×220λ用于控制FSM所需要的4个外部触发器。控制器的高度由PLA的高度加上布置输入和输出的几条导线通道决定。

### 1.10.6 面积估算

![image-20230427215925354](https://gitee.com/ephtiny/image/raw/master/img/202304272159420.png)

估算时需要注意：

- 一定要包括节距为8λ通道的较大的布线通道。
- 大的晶体管显然会占据较大的面积，因此可以把它作为W和L(宽度和长度)的函数在估算面积时作为考虑因素。
- 对于存储器，不要忘记译码器和其他外围电路，因为它们往往会占据和存储位本身同样多的面积。
- 数据通路和阵列通常都能达到比标准单元更高的密度。

## 1.11 设计验证

​	一个设计通常是在体系结构级用一个像C语言这样的模型和在逻辑级通过模拟它的HDL描述来测试它的功能。

![image-20230427220607300](https://gitee.com/ephtiny/image/raw/master/img/202304272206366.png)

​	标准测试程序(testbench)用来验证逻辑是否正确，它使待测逻辑实例化（附录A.12有例子）

​	特殊电路应当进行全面的模拟以保证它们执行预期的 逻辑功能并具有合适的噪声容限。

​	版图对照原理图(Layout vs. Schematic,LVS)工具检查版图中的晶体管连接方式是否与在电路原理图中的相同。设计规则检查(Design Rule Checkers,DRC)用来验证版图是否满足设计规则。电气规则检查(Electrical Rule Checkers,ERC)将搜索其他潜在的问题，如噪声或早期损耗(premature wearout)

## 1.12 制造、封装和测试

- 掩模制造就是用电子束将玻璃上的铬层刻蚀出图案来

​	单个的硅圆片上将同时制造出许多芯片。圆片的直径一般为150～300nm(6～12英寸)。芯片制造需要进行多次的淀积(deposition)、掩模(masking)、刻蚀(etching)和注人(implant)步骤。

- 加工好的圆片将划片成管芯(die),即芯片(chip),并进行封装(package)
- 圆片上甚至一个非常微小的缺陷或者灰尘颗粒都可能使芯片失效。芯片在销售前必须经过测试。

# 2. MOS晶体管原理

## 2.1 引言

![image-20230427222357610](https://gitee.com/ephtiny/image/raw/master/img/202304272223682.png)

​	a中的三端符号在绝大多数电路图中采用；b中四端符号用于需要显示出体(衬底或阱)的连接的电路



​	MOS晶体管是一个多数载流子(majority-camier)器件，它在源漏之间导电沟道中的电流受施加在栅上的电压控制。在nMOS管中，多数载流子为电子；而在pMOS管中，多数载流子为空穴

![image-20230427222657435](https://gitee.com/ephtiny/image/raw/master/img/202304272226506.png)

- (a)中，一个负电压加在栅上，所以在栅上出现了负电荷。于是带正电荷的可移动空穴被吸引到栅下的区域。这称为积累(accumulation)状态
- (b)中，一个小的正电压加在栅上，使栅上产生一些正电荷，于是体中的空穴从栅正下方的区域中被排斥开，从而在栅下形成了一个耗尽(depletion)区
- (c)中，一个更高的正电压加在栅上，它超过了临界的阈值电压V,因而在栅上吸引了更多的正电荷，于是空穴被进一步排斥开并且体中的一些自由电子将被吸引到栅下的区域。这一在p型体硅中的电子导电层称为反型(inversion)层

​	阙值电压取决于体中掺杂剂的数量和栅氧层的厚度t~ox~，通常为正值

![image-20230427223445974](https://gitee.com/ephtiny/image/raw/master/img/202304272234078.png)

- (a)中，==栅至源的电压V~gs~小于阙值电压==。体和源或漏之间形成的结为==零偏置或反偏置==，所以晶体管中几乎没有或完全==没有电流流过==。晶体管关断。这一 工作状态为截止(cutoff)状态

  流过关断晶体管的少量泄漏电流有可能产生严重影响

- (b)中，==栅电压大于阈值电压==。一个称为沟道(channel)的电子(多数载流子)反型区将源和漏连接起来，形成了一条导电通路使晶体管导通。==载流子的数目和导电性随栅电压的增加而增加==。果V~ds~=0(即V~gs~=V~gd~),那么就不存在任何电场可以帮助驱使电流从漏极流向源极。

- (c)中，当一个小的正电压V~ds~加在漏极上时，电流I~ds~将通过沟道从漏极流向源极。这一工作状态称为线性(linear)、电阻性(resistive)、三极管(triode)、非饱和(nonsaturated)或不饱和(unsaturated)状态，此时==电流同时随漏极电压和栅极电压的增加而增加==。

- (d)中，==V~ds~变得足够大使V~gd~<V~t~==，漏极附近的沟道就不再能反型而被夹断(pinched off)，但由于电子在漏极正电压影响下的漂移作用使==晶体管仍然导通==。

  当电子到达沟道末端时，它们射人到漏极附近的耗尽区中并加速流向漏极。==当滑极电压进一步提高时，电流I~ds~将只受栅电压的控制==而不再受漏极电压的影响，此时的工作状态称为饱和(saturation)状态。

​	总之，nMOS管有三个工作状态。**如果V~gs~<V~t~,晶体管截止(关断)**。**如果V~gs~>V~t~晶体管导通**。**当V~ds~较小时，晶体管的作用像是一个线性电阻，它的电流正比于V~ds~**。**当V~gs~>V~t~且V~ds~较大时，晶体管的作用像是一个电流源，它的电流将与V~ds~无关**。

![image-20230427223501260](https://gitee.com/ephtiny/image/raw/master/img/202304272235328.png)

​	pMOS管的工作方式恰好相反。由于n型体硅连至高电平，所以体与p型源极和漏极间形成的结通常反向偏置。**当栅也处在高电平时，漏和源之间没有任何电流流动**。**当栅电压下降了一个阈值电压V~t~时，它将吸引空穴直接在栅下形成p型沟道，使电流能在漏和源之间流动**。

​	们采用V~tn~和V~tp~两项来区分nMOS和pMOS的阈值。



​	习惯上我们都说多数载流子从它们的源流向它们的漏。在静态CMOS门中，晶体管的源极是靠近电源轨线的端口，而漏极是靠近输出的端口。

​	**nMOS管的源极**是源、漏两端口中**电平较低**的一个；**MOS管的源极**是这两端中**电平较高**的一个



​	MOS电路的延时取决于这一电流充电或放电这个电路的电容所需要的时间

​	MOS管的栅极在本质上就是一个具有很薄电介质的良好电容。这一电容的作用就是把裁流子吸引到沟道中而使晶体管工作。

​	从源或漏至体的p-n结是形成附加寄生(parasitic)电容的来源

## 2.2 长沟道晶体管的I-V特性

​	MOS晶体管有三个工作区域：**截止或亚阈值区**、**线性区**、**饱和区**

​	

​	在长沟道模型(long channel)（理想(ideal)、一阶(first-order)或肖克利(Shockley)模型）中，假设沟道足够长，因此横向电场(源和漏之间的电场)相对较弱（这一假设对于纳米器件已不再成立）

​	长沟道模型假设流过一个关断晶体管的电流为0。当晶体管导通(V>V?)时，栅极将吸引载流子(这里是电子)形成沟道。电子以一个与源漏间电场成正比的速率从源极漂移到漏极

​	由在电容每个极 板上的电荷为Q=CV知
$$
Q_{channel}=C_g(V_{gc}-V_t)
$$
​	C~g~为概与沟道间的电容，而V~gc~-V~t~,是超出使p型沟道反型为n型沟道所需最小电压值以外的栅极电压(栅相对于沟道)部分.如果源极电压为V~s~而漏极电压为V~d~那么沟道中的平均电压V~c~=(V~s~+V~d~)/2=V~s~+V~ds~/2。因此在栅电压和沟道电压之间的平均差V~gc~为V~g~-V~c~=V~gs~-V~ds~/2

![image-20230427231658025](https://gitee.com/ephtiny/image/raw/master/img/202304272316116.png)

​	将栅建模为一个平行板电容器，它的电容值正比于平板面积与介质厚度之比。如果栅的长度(即沟道长度)为L,栅的宽度(即沟道宽度)为W,并且栅氧厚度为t~ox~，如图2.6所示，那么栅电容为：
$$
C_g=k_{ox}\epsilon_0\frac{WL}{t_{ox}}=\epsilon_{ox}\frac{WL}{t_{ox}}=C_{ox}WL
$$
​	![image-20230427232410452](https://gitee.com/ephtiny/image/raw/master/img/202304272324532.png)

​	沟道中的每个载流子都被加速到一个平均速度v,这个速度与横向电场即源漏之间的电场成正比。比例常数μ称为迁移率(mohility):

![image-20230428231401735](https://gitee.com/ephtiny/image/raw/master/img/202304282314875.png)

​	电场强度E为漏和源之间的电压差V~ds~除以沟道长度：

![image-20230428231445715](https://gitee.com/ephtiny/image/raw/master/img/202304282314793.png)

​	源和漏之间的电流为沟道中的电荷总数除以越过沟道所需要的时间：

​					      	![image-20230428231546295](https://gitee.com/ephtiny/image/raw/master/img/202304282315381.png)

​	当V~ds~<<V~GT~(V~gs~-V~t~)时，I~ds~几乎随V~ds~而线性增加，就像是一个理想的电阻。

​	晶体管的几何尺寸以及与工艺相关的参数常常被合并成单个的因子β（不要混滑这里的β与在双极型晶体管中表示集电极与基极电流之比所用的同一符号β）。一些书只把与工艺相关的参数合并成一个称为 “k因子”(k prime)的常数

​																									![image-20230428231842940](https://gitee.com/ephtiny/image/raw/master/img/202304282318019.png)

​	当V~ds~>V~dsat~=V~GT~时，在漏极附近的沟道不再反型，我们称它为沟道关断(pinched off)。超过漏极饱和电压点(drain saturation voltage)后，增大漏极电源对电流无影响。饱和电流的表达式（代入V~ds~=V~dsat~）为：

![image-20230428232522371](https://gitee.com/ephtiny/image/raw/master/img/202304282325448.png)

​	上式在V~gs~>V~t~及V~ds~>V~dsat~时成立，长沟道MOS管在饱和区显示了平方律的行为(aquare-law behavior)特性。

​	

​	晶体管两个关键的性能指标是I~on~和l~off~。I~on~(也称为I~dast~)是V~gs~=V~ds~=V~DD~时的导通电流I~ds~。I~off~是V~gs~=0及V~ds~=V~DD~时的关断电流。根据长沟道模型，I~off~=0及

![image-20230428233113404](https://gitee.com/ephtiny/image/raw/master/img/202304282331480.png)



​	这三个区域的电流如下：

![image-20230428233141776](https://gitee.com/ephtiny/image/raw/master/img/202304282331842.png)

​	这里忽略了一些对小于1nm的工艺影响很大的效应

![image-20230428233528769](https://gitee.com/ephtiny/image/raw/master/img/202304282335867.png)

​	

​	pMOS管中电流从源极流向漏极。硅中空穴的迁移率通常要小子电子的迁移率。这意味着pMOS 管提供的电流比具有相同尺寸的nMOS管要小，因而它也较慢些。

​	符号μ~n~和μ~p~用来分别区分nMOS和pMOS管中电子和空穴的迁移率。

## 2.3 C-V特性

​	MOS晶体管的每个端口对其他端口间都有电容。这些电容都是非线性的并且与 电压有关(C-V)。在一个逻辑门的翻转电压范围内取平均时，它们近似成 一个简单的电容。

### 2.3.1 简化的MOS电容模型

栅电容：一个平行板电容器，顶部为栅，底部为沟道。电容为：$C_g=C_{ox}WL$

​	把栅电容近似成它的一端处在源极上而称它为C~gs~

​	对于一个具体工艺，可以将这个最小沟道长度L看成是一个常数

![image-20230501165310905](https://gitee.com/ephtiny/image/raw/master/img/202305011653045.png)

​	除了栅以外，源和漏也有电容。它们会影响电路的性能，因而被称为寄生(parasitic)电容。它们来源于源或漏扩散区与体之间的p-n结， 因此也称为扩散(diffusion)电容C~sb~和C~db~。这些结电容的大小取决于源和漏扩散区的面积和周长、扩散区的深度、掺杂浓度和电压。

![image-20230501165519270](https://gitee.com/ephtiny/image/raw/master/img/202305012104792.png)

​	(a)中每个源极和漏极都有它自己独立的(isolted)带接触的扩散区；(b)中底部晶体管的漏极和顶部晶体管的源极一起形成了一个共享的(shared)带接触的扩散区；(c)中源极和漏极合并(merged)成了一-个不带接触的区域

​	带接触的源区和漏区的扩散电容C~sb~和C~db~与栅电容很相近；带接触的源区和漏区的扩散电容稍小些，因为它们的面积较小些

### 2.3.2精确的MOS栅电容模型

​	栅电容由两部分组成：本征电容C~gc~(沟道上方)和覆盖电容(overlap cepacitance)C~gol~(与源区和漏区相覆盖的部分)。

​	本征电容的的下极板与晶体管的工作状态有关

​	本征电容有三个组成部分，分别代表和下极板相连的三个端口与栅之间的电容：C~gb~(栅与体)、C~gs~(栅与源)和C~gd~(栅与漏)。

![image-20230501174212261](https://gitee.com/ephtiny/image/raw/master/img/202305011742347.png)

​	(a)为在截止区当V~ds~较小时电容与V~gs~的关系图；(b)为在线性区和饱和区时电容与V~ds~的关系图

- 截止区(cutoff)。当晶体管截止(V~gs~<V~t~)时，沟道没有反型并且栅上的电荷与体硅中极性 相反的电荷相匹配。此时的电容称为C~gs~,即栅与体之间的电容。对于负的V~gs~,晶体管处于积累状态，C~gb~=C~0~。当V~gs~增加但仍保持低于阑值时，在沟道表面形成了一个耗尽区，这实际上使下极板从栅氧层下移，因而减少了电容，如图2.9(a)所示。

- 线性区(linear)。当V~gs~>V~t~时，沟道反型并再次成为导电良好的下极板。但由于沟道与源和漏导通而与体不导通，所以C~gb~下降至0。当V~ds~较低时，沟道电荷大致在源端和漏端之间平均分配，所以C~gs~=C~gd~=C~0~/2。但当V,增加时，接近漏端的反型区域减小，所以这一电容中的大部 分电容将来自子源端，而只有一小部分来自孺端，如图2.9(b)所示。

  饱和区(saturation)。当V~ds~>V~dsat~时，晶体管饱和且沟道被夹断。此时所有的本征电容都集中 在源极，如图2.9(b)所示。由于沟道被夹断，他和时一个理想晶体管的栅电容为C~gs~=2/3C~0~。

​	以上三个区城的栅电容情况近似如下表

![image-20230501174751510](https://gitee.com/ephtiny/image/raw/master/img/202305011747685.png)

​	在一个实际的器件中，栅与源和漏之间有部分相覆盖，而且还有终止于源和滑的边缘电场(fringing field)存在，从而形成了附加的覆盖电容

![image-20230501174905145](https://gitee.com/ephtiny/image/raw/master/img/202305011749341.png)

​	这些电容正比于晶体管的宽 度，它们的典型值为C~gsol~=C~gdol~=0.2~0,4 fF/μm。总的电容为它们与本证栅电容相加

![image-20230501175019658](https://gitee.com/ephtiny/image/raw/master/img/202305011750717.png)

​	等效栅电容将随源和漏端的翻转活动性而变化

![image-20230501175058419](https://gitee.com/ephtiny/image/raw/master/img/202305011750492.png)

​	为了计算数字电路的延时，我们通常把C~g~=C~gs~+C~gd~+C~gb~近似为C~0~+2C~gol~W,或者采用从模拟中提取的等效电容值（这一模型明显高估了恰在阐值以下工作的晶体管电容）

### 2.3.3精确的MOS扩散电容模型

![image-20230501175350243](https://gitee.com/ephtiny/image/raw/master/img/202305011753339.png)

​	源扩散区的面积为AS=WD,而周长为PS=2W+2D。在这一周长中，与沟道相邻部分的周长为W,而其余不相邻部分的周长为W+2D。

总的源区寄生电容为：

![image-20230501175259675](https://gitee.com/ephtiny/image/raw/master/img/202305012104075.png)

​	C~jbs~(体和源区底部间的结电容)的单位为电容/面积，而C~jbssw~(体和源区侧壁间的结电容)的单位为电容/长度。

​	由于耗尽区的厚度取决于偏置状态，所以这些寄生电容都是非线性电容。面积结电容这一项为

![image-20230501175417604](https://gitee.com/ephtiny/image/raw/master/img/202305011754657.png)

​	C~J~为零偏置时的结电容，它与工艺密切相关。M~J~为结缓变系数(junction grading coeffcient),它与扩散结的缓变程度有关，典型范围为0.5~0.33。 $\psi$~0~是内建势(built-in potential),它取决于掺杂浓度。

![image-20230501175709150](https://gitee.com/ephtiny/image/raw/master/img/202305012104908.png)

​	vg为热力学中的热电压(themmal voltag)，它的值为kT/q(室 温下为26mV),式中k=1.380×10^-23^J/K是玻耳兹曼常数，T为绝对温度(室温为.300K),而 q=1.602×10^-19^C为电子电荷

​	N~A~和N~D~分别为体和源扩散区的掺杂浓度。n~i~为未掺杂硅中的本征载流子浓度，它在300 K时的值为1.45×10^10^cm^-3^。

![image-20230501175955595](https://gitee.com/ephtiny/image/raw/master/img/202305011759756.png)

![image-20230501180012831](https://gitee.com/ephtiny/image/raw/master/img/202305011800925.png)



![image-20230501180032935](https://gitee.com/ephtiny/image/raw/master/img/202305011800994.png)

​	可以把MOS晶体管看成是一个四端器件，它的每一对端口之间都存在电容

## 2.4 非理想的I-V效应

![image-20230501180136631](https://gitee.com/ephtiny/image/raw/master/img/202305011801964.png)

​	饱和电流随V~gs~的增长小于平方律的增长。这是由两个效应引起的：速度饱和(velocity saturation)与迁移率退化(mobility degradatio)

- 速度饱和：当横向电场强度(V~ds~/L)很大时，载流子速度不再随场强线性增加。)。它使I~ds~在V~ds~较大时小于预期值
- 迁移率退化：当纵向电场强度(V~gs~/t~ox~)很大时，载流子由于经常发生散射而偏离栅氧界面，这使它们沿沟道方向的进程减慢。使电流在V~gs~较大时小于预期值。

​	**阙值电压**是表示**使沟道反型所需要的栅电压**，主要由栅氧厚度和沟道掺杂浓度决定

晶体管中的其他电场也会对沟道产生某些影响

- 有几个泄漏原因使在名义上关断的晶体管中有电流流过。当V~gs~<V~t~时，电流将按指数方式下降而不是立即变为0,这称为**亚阙值导电**(subthreshold conduction)。
- 由于栅氧厚度已减小到只有几个原子层的厚度，因此电子可以隧穿(tunnel)到栅中引起某些栅泄漏(gate leakage)电流
- 然源和滑扩散区通常是反向偏置的二极管，但它们也有进入衬底或阱的结泄漏(junsction leakage)电流。

​	==迁移率和阈值电压都随温度升高而减小==，==MOS管的特性随温度升高而变差。==

- **对于充分导通的晶体管**，==在高温下I~ds~减小==
- **对于关断的晶体管**， ==高温下的 泄漏电流较大==

### 2.4.1 迁移率退化和速度饱和

​	流子的漂移速度(drift velocity)因而电流正比于在源和漏之间的横向电场 E~lat~=V~ds~/L,这一比例常数称为载流子的迁移率μ。

- **迁移率退化**：晶体管栅上的高电压把载流子吸向沟道的边缘，引起了电子与栅氧界面的碰撞从而减慢了载流子的速度
- **速度饱和**：当应用高电场时，载流子也会达到一个最大速度v~sat~

下面是一个普适的模型：

![image-20230501181224742](https://gitee.com/ephtiny/image/raw/master/img/202305011812837.png)



![image-20230501181245544](https://gitee.com/ephtiny/image/raw/master/img/202305011812671.png)

​	在低电场时，速度随电场而线性增长，它的斜率就是迁移率μ~eff~。当电场高于一个临界值E~c~时，速度曲线将在v~sat~处变为水平，对于电子v~sat~近似为10^7^cm/s,而对于空穴近似为8×10^6^cm/s

载流子的速度：

![image-20230501181440476](https://gitee.com/ephtiny/image/raw/master/img/202305011814524.png)

临界电场强度(critical electric field)：

![image-20230501181509573](https://gitee.com/ephtiny/image/raw/master/img/202305011815621.png)

临界电压(critical voltage)V~c~是达到临界有效电场时的漏源电压：V~c~=E~c~L



线性区和饱和区电流的改进公式：

![image-20230501181618882](https://gitee.com/ephtiny/image/raw/master/img/202305011816930.png)

​	由于迁移率退化，μ~eff~随V~gs~增加而减小

饱和电压值：

![image-20230501181658940](https://gitee.com/ephtiny/image/raw/master/img/202305011816986.png)

​	V~dsat~比V~GT~和V~c~都小

考虑速度饱和时饱和电流的简化表达式：

![image-20230501181807351](https://gitee.com/ephtiny/image/raw/master/img/202305011818426.png)

​	如果V~GT~<<V~c~，速度饱和效应就可以忽略不计，而V~GT~>>V~c~，则接近速度饱和的极限

![image-20230501181957883](https://gitee.com/ephtiny/image/raw/master/img/202305011819925.png)

​	在长沟道状态下漏极电流与电压成平方关系而当速度充分饱和时它与电压成线性关系

​	在中等大小的电源电压下，晶体管将工作在载流子速度既不是随电场线性增加也不是完全饱和的区城



α指数律模型(α-power law model)

![image-20230501182141069](https://gitee.com/ephtiny/image/raw/master/img/202305011821263.png)

![image-20230501182147428](https://gitee.com/ephtiny/image/raw/master/img/202305011821465.png)

​	该模型基于三个参数：α、BP~c~和P~v~

​	α称为速度饱和指数(velocity gturation inde)

- 具有长沟道或低V~DD~的晶体管在饱和区表现出平方律的I-V特性，因而可以模拟 成α=2的情形。
- 当晶体管变得较为速度饱和时，增大V~gs~对电流的影响减小，因此α减小并且当晶体管完全速度饱和时α将为1

![image-20230501202341275](https://gitee.com/ephtiny/image/raw/master/img/202305012023378.png)

​	图2.16的为α=1.3的模型和模拟结果



​	由于低电场下空穴的迁移率比电子要低得多，所以对于给定的V~DD~,pMOS管经受速度饱和的程度比nMOS管低。

​	**pMOS管的α值比nMOS管大**。

​	

​	图2.17画出了V~ds~出与V~gs~的关系(保持V~ds~=V~gs~不变),这相当于画I~on~与V~DD~的关系图。对于明显大于V~t~的V~gs~，I~ds~与直线拟合得相当好

​	导通电流近似为：

![image-20230501202602593](https://gitee.com/ephtiny/image/raw/master/img/202305012026650.png)

​	V~t~^*^是拟合直线与x轴交点处的值。

### 2.4.2 沟道长度调制

![](https://gitee.com/ephtiny/image/raw/master/img/202305012027802.png)

​	这一耗尽区实际上将沟道长度缩短为：L~eff~=L-L~d~

​	增加V~ds~将减少有效的沟道长度，较短的沟道长度会导致较大的电流，因此在饱和区I~ds~将随V~ds~而增加。在饱和区有

![image-20230501203318018](https://gitee.com/ephtiny/image/raw/master/img/202305012033087.png)

​	其中V~A~称为厄尔利电压(Early voltage)，V~A~与沟道长度成正比

### 2.4.3 阐值电压效应

​	实际上**V~t~随源极电压增加而增加，随体电压增加而减小，随漏极电压增加而减小，以及随沟道长度增加而增加**

==（个人觉得看记住上面的就行，具体式子不用记）==

#### 2.4.3.1 体效应

​	体实际上是晶体管隐含的第四个端口

​	当在源和体之间加上电压V~sb~时它将使沟道反型所需要的电荷量增加，因而使阙值电压提高。

阈值电压可以建模为：

![image-20230501204103641](https://gitee.com/ephtiny/image/raw/master/img/202305012041705.png)

​	V~t0~为当源与体具有相同电位时的阈值电压，$\phi$~s~为在阔值条件下的表面势(suface potential)，$\gamma$为体效应系数 (hody effeet coeffcient)。所有这些参数又与沟道的掺杂浓度N~A~ 有关。

![image-20230501204355435](https://gitee.com/ephtiny/image/raw/master/img/202305012043484.png)

​	当加在源或体上的电压较小时，V~t~式可以近似为线性关系：

![image-20230501204447046](https://gitee.com/ephtiny/image/raw/master/img/202305012044100.png)

![image-20230501204454197](https://gitee.com/ephtiny/image/raw/master/img/202305012044249.png)

#### 2.4.3.2 漏致势垒降低

​	由漏极电压V~ds~引起的电场将影响阙值电压。这一漏致势垒降低(Drain-Induced Barrier Lowering，DIBL)效应在短沟晶体管中更为明显。它可以建模为：V~t~=V~t~-ηV~ds~

​	η为DIBL系数，它的典型值在0.1(常表示成100 mV/V)左右。

​	漏致势垒降低将引起饱和区的I~ds~随V~ds~而增加

#### 2.4.3.3 短沟效应

​	阙值电压一般随沟道长度而增大

​	对于短沟道L，由于源和漏耗尽区延伸到沟道中的部分更为显著，所以这一现象特别突出，为此它被称为短沟效应(short channel effect)或V~t~滚降(rolloff)

​	除此外还有反短沟效应( reverse short channel effect)、窄沟效应( narrow channel effect)

### 2.4.4 泄漏

![image-20230501205512084](https://gitee.com/ephtiny/image/raw/master/img/202305012055154.png)

​	泄漏机理包括**在源和漏之间的亚阈值导电**、**从栅至体的概泄漏**，以及**从源至体和从漏至体的p-n结泄漏**

- 亚阈值导电是由于载流子热致发射越过了由阈值决定的势垒而引起
- 栅泄漏是因隧穿通过极薄栅介质而引起的一种量子力学效应
- 结泄漏是因电流通过在源/漏扩散与体之间的 p-n结而引起

#### 2.4.4.1 亚阈值泄漏

![image-20230501205818637](https://gitee.com/ephtiny/image/raw/master/img/202305012058711.png)

​	实际的晶体管中，电流并不在阙值以下时立即截止，而是如图中看到的那样按指数规律下降

​	由于漏致势垒降低，亚阈值电流(subthreshold leakage curent)将随V~ds~而显著增加

​	漏极的结泄漏决定了I~ds~的下限值，这一结泄漏在负栅压的情况下将更严重

![image-20230501210742406](https://gitee.com/ephtiny/image/raw/master/img/202305012107458.png)

​	这里描述了亚阙值泄漏电流。I~ds0~为在阈值时的电流

​	亚阈值电流在半对数坐标平面上能和一条直线符合得很好。这条直线斜率 的倒数称为亚阈值斜率(subthreshold slope)S:

![image-20230501210858894](https://gitee.com/ephtiny/image/raw/master/img/202305012108954.png)

​	亚阐值斜率表明为了使亚阔值泄漏电流减小一个数量级应当使栅电压下降多少

![](https://gitee.com/ephtiny/image/raw/master/img/202305012109770.png)

​	I~off~为V~gs~=0及V~gs~=V~DD~时的亚阔值电流。

#### 2,4.4.2 栅泄漏

​	载流子这一越过薄绝缘层壁垒的效应称为隧穿(tumneling),它将引起穿过栅极的泄漏电流。

​	引起栅极隧穿的两个物理机理称为Fowler-Nordheim(FN)隧穿和直接隧穿(direet tunneling)。

​	直接栅隧穿电流可以用下式估算：

![image-20230501211138205](https://gitee.com/ephtiny/image/raw/master/img/202305012111277.png)



![image-20230501211304501](https://gitee.com/ephtiny/image/raw/master/img/202305012113564.png)

​	图2.21为对于不同的栅氧厚度，栅泄漏电流密度(电流/面积)J~G~与电压的关系图。

​	采用SiO~2~作为栅介质时，nMOS管的隧穿电流比pMOS管大一个数量级

#### 2.4.4.3 结泄漏

![image-20230501211544100](https://gitee.com/ephtiny/image/raw/master/img/202305012115170.png)

​	扩散与衬底或阱之闻的p-n结形成了二极管，而阱至衬底之间的结形成了另一个二极管，在正常操作时为了保证这些二极管不变成正向偏置，衬底和阱应连至GND或V~DD~。但反向偏置的二极管仍然会导通少量的电流I~D~

![image-20230501211629084](https://gitee.com/ephtiny/image/raw/master/img/202305012116147.png)

​	I~S~取决于掺杂浓度及扩散区的面积与周长，而V~D~是二极管电压(例如-V~sb~或-V~db~)。当一个结的反向偏置明显大于热电压时，结泄漏即为  -I~s~

​	重掺杂的漏极会出现带至带隧穿(Band-to-Band Tunneling,BTBT)及栅致漏极 泄漏(Cate-Induced Drain Leakage,GIDL)。

​	当称为陷阱(trap)的硅晶 格中的缺陷使载流子隧穿必须经过的距离缩短时，这一泄漏会因陷阱辅助隧穿(Trap-Assisted Tunneling,TAT)而进一步加剧。这一泄漏大部分发生在沿侧壁最靠近沟道的地方，因为那里的 掺杂浓度最高。它可以建模为：

![image-20230501212324494](https://gitee.com/ephtiny/image/raw/master/img/202305012123550.png)

​	在反向偏置电压为V~DD~时沿结的电场为：

![image-20230501212405267](https://gitee.com/ephtiny/image/raw/master/img/202305012124331.png)

### 2.4.5 温度相关性

​	晶体管的特性受温度的影响，如载**流子迁移率随温度升高而降低**。一个近似的关系为：

![image-20230501212718001](https://gitee.com/ephtiny/image/raw/master/img/202305012127055.png)

​	**阈值电压的幅度大致随温度呈线性关系减小**，它可以近似为下式：

![image-20230501212740517](https://gitee.com/ephtiny/image/raw/master/img/202305012127577.png)

​	**在高V~DD~时的I~on~随温度升高而减小。亚阈值泄漏随温度呈指数关系增大。BTBT随温度缓慢增长，而栅泄漏几乎与温度无关。**

![image-20230501212901679](https://gitee.com/ephtiny/image/raw/master/img/202305012129756.png)

​	在高V~gs~时，电流具有负温度系数；在低V~gs~时，电流具有正温度系数

​	高温时的电路性能最差。但当系统工作在低V~DD~(一般小于0.7～1.1V)时，I~dsat~却随温度升高而增加。因此可以通过冷却来提高电路性能

​	由于亚阙值泄漏与温度呈指数关系，所以在低温下可以采用较低的阙值电压。低温时速度饱和将发生在较高的电场下，因而能提供更大的 电流。由于低温时迁移率也较大，所以达到速度饱和的电场强度时，电源电压仍比较低，因而能 降低功耗。此外，低温时的耗尽区变宽，使结电容减小。

### 2.4.6 几何形状相关性

​	版图设计者画晶体管时它的宽度为W~drawn~、长度为L~drawn~，但实际的栅极尺寸有可能分别与它们相差X~W~和X~L~。另外。由下源区和漏区往往会横向扩散到栅以下一段距离L~D~，也使载流子必须在源和漏之间横越的等效沟道长度变短。W~D~考虑了使晶体管的宽度变窄的其他原因

![image-20230501213520986](https://gitee.com/ephtiny/image/raw/master/img/202305012135048.png)

### 2.4.7 小结

- **阈值损失**

  输管在传送不适合于它传送的电平时会有阙值损失：nMOS管在传送高电平时只能上拉至V~DD~-V~tn~,而pMOS管在传送低电平时只能下拉至|V~tp~|，阔值损失的大小会因体效应而增加。当必须同时能很好地传送0和1时应当采用全互补传输门。

- **泄漏电流**

  当前最主要的泄漏来源是在一个应当关断的晶体管中它的源和漏之间的亚阔值泄漏

  非常薄的栅氧有明显的隧穿电流流过

  泄漏还会在高温时加大

- **V~DD~**

  度饱和与迁移率退化使在高电压下的电流小于预期的电流值。应采用高V~DD~来实现快速的晶体管

- **延时**

  串联晶体管往往要比由简单模型预测的速度快些

  两个串联nMOS管提供的电流要大于相同宽度单个晶体管电流的一半。nMOS管的这一效应比pMOS管更为突出，因为nMOS管本身的迁移率较大，因而速度饱和程度也较大。

- **匹配**

  果两个晶体管的行为必须完全一样，那么它们应当同时具有相同的尺寸和取向，并且尽可能采用叉指型(interdigitated)设计。

## 2.5 直流传输特性	

​	一个电路的直流传输特性 (DC transfer characteristics)是指假设输人信号的变化足够慢因而电容有充分的时间充电和放电时，它的输出电压和输入电压的关系。输入和输出电压的具体范围定义为有效的逻辑电平0和1。

### 2.5.1 静态CMOS反相器的直流特性

![image-20230501214602274](https://gitee.com/ephtiny/image/raw/master/img/202305012146343.png)

​	V~tn~为n沟器件的阈值电压，而V~tp~为p 沟器件的阈值电压。V~tp~为负值

![image-20230501215006568](https://gitee.com/ephtiny/image/raw/master/img/202305012150650.png)

![image-20230501215104497](https://gitee.com/ephtiny/image/raw/master/img/202305012151576.png)



**静态CMOS反相器的直流传输函数(即V~out~与V~in~的关系)**：

![image-20230501215144724](https://gitee.com/ephtiny/image/raw/master/img/202305012151783.png)

​	由于晶体管在饱和区并不是理想的电流源，过渡区不是非常陡

​	当Y~inv~= V~in~=V~out~时的交叉点称为输入阈值( input thueshold)。 由于nMOS和pMOS管所迁移率和阈值电压数值都随温度升高而减小，所以一个逻辑门的输人阈值对温度的敏感性很弱。

### 2.5.2 β比例效应

​	当$\beta$~p~=$\beta$~n~时反相器的阙值电压V~inv~等于V~DD~/2。

​	具有不同β比r=B~p~/B~n~ 的反相器称为偏斜(skewed)反相器。。如果r>1,反相器称为高偏斜(HI-skewed) 反相器；如果r<1,反相器称为低偏斜(L0-ekewed)反相器；如果r=1,反相器具有标准偏斜 (normal skew)或称为不偏斜(unskewed)反相器。

​	高偏斜反相器具有较强的pMOS管，因此如果输人为V~DD~/2,我们叫以预见它的输出将大于 V~DD~/2。换言之，它的输人阙值必定大于不偏斜的反相器。类似地，一个低偏斜反相器具有较弱的pMOS管，因而具有较低的翻转阈值。

![image-20230501222850043](https://gitee.com/ephtiny/image/raw/master/img/202305012228129.png)

​	假设饱和晶体管的长沟道模型成立：

![image-20230501223049379](https://gitee.com/ephtiny/image/raw/master/img/202305012230450.png)

​	使这两个电流相等但符号相反有：

![image-20230501223137242](https://gitee.com/ephtiny/image/raw/master/img/202305012231305.png)

​	当晶体管达到速度完全饱和的极限情况时有;

![](https://gitee.com/ephtiny/image/raw/master/img/202305012232389.png)

​	重新定义r=W~p~v~sat-p~/W~n~v~sat-n~,，可以求出反相器的阔值为：

![image-20230501223310917](https://gitee.com/ephtiny/image/raw/master/img/202305012233992.png)

​	无论上述哪种情况，当V~tn~=-V~tp~,及r=1时，都可以得到V~inv~=V~DD~/2。但速度饱和的反相器对偏斜更为敏感，这是因为它们的直流传输特性不太陡峭。

### 2.5.3 噪声容限

​	噪声容限(noise margin)与直流电压特性密切相关

最常用来描述噪声容限的两个参数：即**逻辑低(LOW)噪声容限NM~L~**和**逻辑高(HIGH)噪声容限NM~H~**。

![image-20230502101137025](https://gitee.com/ephtiny/image/raw/master/img/202305021011179.png)

- NM~L~定义为接收逻辑门能识别的最大逻辑低(LOW)输入电压与驱动逻辑门能产生的最大逻辑低(LOW)输出电压之间的差：MM~L~=V~IL~ - V~OL~
- NM~H~定义为驱动逻辑门能产生的最小逻辑高(HICH)输出电压与接收逻揖门能识别的最小逻辑高(HIGH)输人电压之间的差：NM~H~=V~OH~-V~IH~

![image-20230502101420089](https://gitee.com/ephtiny/image/raw/master/img/202305021014155.png)

​	V~IL~和V~IH~之间的输人范围称为不确定区(indeterminate region)或禁区(forbidden zone)

![image-20230502102003372](https://gitee.com/ephtiny/image/raw/master/img/202305021020455.png)

​	图中所示的反相器，NM~L~为0.46 V~DD~而NMg为0.13 V~DD~。

​	当输人处在其最坏情形下的合法数值时，输出电平会变得稍差些，这称为噪声穿通(noise feedthrough)或传播噪声(propagated noise)

​	一个逻辑门的NM~L~或NM~H~中只要有一个太小，这个门就可能因输人上的噪声而被扰动。一个**不偏斜的逻辑门**具有**相同的逻辑高和逻辑低噪声容限**，因而在兼顾随意的(即同时考虑逻辑高和逻辑低)的噪声来源时，它具有**最大的抗噪声能力**

​	如果一个门的高输人状态或低输入状态中有一种状态下它所遇到的噪声较大，那么可以把这个门设计成偏斜的门以提高在那种状态下的，但会牺牲另一种状态下的噪声容限

​	如果|V~tp~I=V~tn~,那么NM~H~ 和NM~L~将随阙值电压的增加而增加

​	常常以牺牲噪声容限来换取速度的改善

### 2.5.4 传输管的直流特性

![image-20230502102851779](https://gitee.com/ephtiny/image/raw/master/img/202305021028851.png)

- (a)中nMOS管的栅和漏都连至V~DD~。可以假设源最初处于V~s~= 0。由于V~gs~>V~tn~,所以晶体管导通并有电流流过。现在如果源极上的电压上升至V~s~=V~DD~-V~tn~,那么 V~gs~下降至V~tn~因而晶体管将使自己关断。因此，试图传输1的nMOS管绝不可能将源上拉至 V~DD~-V~tn~以上。这一电平损失常常称为阙值损失(threshold drop)

  而且当nMOS管的源极电压上升时，V~sb~不再为零。这一非零的源至体电压将引起体效应使阈值电压升高

- 对(b)，当pMOS管的源极电压下降到IV~tp~I以下时，它将截止。因此，pMOS管最低只能将输出下拉至GND以上一个阈值电压

- 对(c)，由于一个nMOS管的源极最高可以上升至栅极电压以下一个阔值电压，因此几个串联nMOS管的输出不会比单个nMOS管的输出降低得更多

- 对(d)，如果用降低了的输出驱动另一个晶体管的栅极，那么这第二个晶体管就会产生甚至更进一步降低的输出

​	一个传输门由一个nMOS管和一个pMOS管并联组成，它们的栅分别 由两个互补的信号控制。当传输门导通时，对于任何输出电压，它的两个晶体管中至少有一个是导通的，因此传输门传输0和1都很好。

​	传输门的作用就像是一个连接输入和输出的电压控制开关。

## 2.6 常见隐患与误区

- 盲目相信某种模型
- 使用过于复杂的模型进行手工计算
- 认为所画长度为两倍的晶体管恰好具有一半大小的电流
- 认为两个串联晶体管所提供的电流恰好为单个晶体管的一半
- 忽略泄漏
- 采用nMOS传输管

# 3. CMOS工艺技术

## 3.1 引言

​	元素周期表中的III族元素如硼作为杂质时吸收电子， 它们被称为受主(acceptor),因为它们接受在硅中已经存在的某些电子。类似地，V族元素如砷和磷称为施主(donor)元素，因为它们提供电子。含大量施主的硅称为n型(n-ype)硅，而含大量受主的硅称为p型(p-type)硅。当n型和p型材料放在一起相接触时，从n型硅到p型硅的过渡区域称为结(junction)。

## 3.2 CMOS工艺

步骤：生产线前端( Front-End-of-Line,FEOL)阶段形成晶体管，而在生产线后端(Back-End-of-Line,BEOL)阶段形成导线

### 3.2.1 制备圆片

最常用的方法：Czochralski方法

​	从坩锅中熔化了的纯硅上拉出单晶硅锭，从圆柱状的单晶硅锭切割圆片

![image-20230502111336324](https://gitee.com/ephtiny/image/raw/master/img/202305021113411.png)

​	籽晶拉出和旋转的速率决定了单晶硅锭的直径。

### 3.2.2 光刻

​	在圆片上用掩膜定义我们要处理区域(即我们希望在那里保留或除去材料)的主要方法是采用光刻胶(photoresist)。圆片先涂以 一层光刻胶并使它通过光掩模(photomask)进行有选择的光照。

![image-20230502112248828](https://gitee.com/ephtiny/image/raw/master/img/202305021122908.png)

​	光掩模上有铬的地方将阻挡光照。紫外光从光掩模的背面射人并通过掩模上能透光的部分照射到预先涂覆在圆片上的有机光刻胶(photoresist,即 PR)上使它曝光。然后用显影溶液溶解掉光刻胶上未被噪光的可溶解部分，而光刻胶上经过曝光的部分因变得不可溶解而被保留了下来。

​	这样一种光刻胶称为负性(negative)光刻胶。而正性 (positive)光刻胶最初是不可溶解的，当经过紫外线曝光后就变得可溶

​	正性光刻胶比负性光刻胶能提供更高的分辨率，但光敏性较差些。随着特征尺寸变得越来越小，光刻胶层也必须变得更薄



​	光源波长将影响能被曝光制作的最小特征尺寸

​	定义一个工艺的最小节距(pitch)即“宽度+ 间距”为2b。物镜的分辨率取决于光的波长λ和该物镜的数值孔径(Numerical Aperture,NA):

![image-20230502114026106](https://gitee.com/ephtiny/image/raw/master/img/202305021140168.png)

​	波长与特征尺寸相当或比它更大时将会使光刻胶上被曝光的图案产生偏差。分辨率增强技 术(Resolution Enhancemnent Technique,RET)可以对这一偏差进行预补偿以得到所希望的图案

![image-20230502115550655](https://gitee.com/ephtiny/image/raw/master/img/202305021155743.png)

​	相移掩模(Phase Shift Mask,PSM)利用在掩模上平行线条的衍射光栅效应(diffraction grating effect),通过改变掩模本身的厚度来改变光的相位，使来自掩模上相邻两条线条的光相位相反，因而它们在不希望有光的地方恰好相互抵消。

​	离轴照明(of-axis illumination)也可以用来改善一定类型的密集和重复图案的对比度。 两次曝光成像(double-patteming)是对同一层光刻 胶采用不同的掩模先后进行两次精确对准的曝光步骤

### 3.2.3 形成阱和沟道

几种主要的CMOS工艺：**n阱工艺**、**p阱工艺**、**双阱工艺**、**三阱工艺**

- 在p阱工艺中，nMOS管制造在p阱中而pMOS管制造在n型衬底上，p阱工艺曾因此用来优化pMOS管的性能。
- 在n阱工艺中，在同一个n阱中的各组pMOS管共享相同的体节点，但与不同肼中pMOS管的体 相隔离。而芯片中的所有nMOS管都共享同一个体，即衬底。
- 双阱工艺可以同时优化每一种类型的晶体管。
- 三阱工艺在混合信号芯片中的模拟模块和数字模块之间提供了良好的隔离，它也用来使高密度的动态 存储器与逻辑部分之间隔离。



利用外延(epitary)、淀积(deposition)或注入(implancation)可以实现施主和受主掺杂剂的不同浓度

- 外延可以用来形成一层缺陷比原有圆片表面少的硅层并能有助于防止闩锁
- 淀积是将掺杂剂材料先堆积在硅表面上然后采用热扩散步骤迫使它推进到体硅内。
- 离子注人是用高能量的施主或受主原子轰击硅衬底。

​	对于给定的栅材料和村底材料，阀值电压取决于 衬底的掺杂浓度(N~A~)、栅氧厚度(t~OX~)及表面态电荷(Q~fc~)。离子注入可以同时影响N?和Qg,因 而也影响V~t~

![image-20230502121610094](https://gitee.com/ephtiny/image/raw/master/img/202305021216205.png)

​	nMOS管位于布置在深n阱中的p阱内，pMOS 管位于浅(即正常)n阱中

![image-20230502122244511](https://gitee.com/ephtiny/image/raw/master/img/202305021222601.png)

​	逆向掺杂阱(retmograde well)边缘附近(例如在约1μm以内)的晶体管与远离该阱边缘的晶体管也许会有不同的阙值电压，这是由于离子散射偏离了光刻胶掩模而进入到阱的边缘。这称为阱边缘邻近效应( well-edge proximity eflect)。

### 3.2.4 二氧化硅(SiO~2~)

硅的氧化方法;

- 湿氧化(wet oxidation)——此时氧化环境含水蒸气。温度通常在900°C至1000°C之间。当采用氢和氧的比例为2:1的混合物时，它也称为加热合成氧化(pyrogenic oxidation)。湿氧化是一种快速氧化工艺。
- 干氧化(dry oxidation)——此时氧化环境是纯氧气。温度在1200°C左右以达到可接受的生长速度。干氧化形成的氧化层质量比湿氧化好。它用来形成可高温控制的薄栅氧，而湿氧化可用来形成厚场氧。
- 原子层淀积(Atomic Layer Deposition,ALD)——此时一层很薄的化学物质(材料A)附在表面上，然后引人另一种化学物质(材料B)来生成所要求的薄层(即SiO?——这种方法也可以用来形成其他各种电介质和金属层)。这一工艺然后重复多次，使一层接一层地形成所要求的层

​	氧化工艺完成后，在原来未氧化的硅 表面上下都会凸起SiO~2~

### 3.2.5 隔离

​	CMOS工艺中的各个单个器件必须相互隔离，这样它们之间就不会出现不希望有的互相作用。尤其是沟道只应当在有源区上晶体管栅极以下被反型，在其他地方布置的导线不应当引起寄生的MOS沟道，而且不相关晶体管的源/滑扩散区不应当相互干扰。

![image-20230502132031822](https://gitee.com/ephtiny/image/raw/master/img/202305021320938.png)

### 3.2.6 栅氧

![image-20230502132243845](https://gitee.com/ephtiny/image/raw/master/img/202305021322917.png)

​	这一氧化物结构称为栅叠层(gate stack)

​	对于给定的氧化层厚度，它的行为如同一层较薄的栅氧层。能采用较厚的氧化层意味着可以提高工艺的稳定性

### 3.2.7 形成栅和源/漏

​	未掺杂的多晶硅具有较高的电阻率。通过对它注入掺杂剂和/或把它和难熔金属组合在一起可以降低它的电阻率。多晶硅栅可以用来作为掩模使源和漏能在栅的两边精确对准。这一工艺称为自对准多晶硅栅(self-aligned polyailicon gate)工艺。

![image-20230502132734899](https://gitee.com/ephtiny/image/raw/master/img/202305021327008.png)

在自对准多晶硅栅工艺中确定栅、源和漏的步骤：

- (a)：在需要有晶体管的地方生长栅氧(其面积=源+漏+栅)——而在其他地方将是厚氧层或 沟槽隔离
- (b)：在芯片上淀积多晶硅
- (c)：使多晶硅形成图案(同时包括栅和互连线)
- (d)：刻蚀掉暴露的树氧层——即在需要有晶体管的栅氧层中未被多晶硅覆盖的区域。在这一阶段， 凡需要有源/漏扩散的地方，芯片上就会有一个向下通向耕或衬底的密口
- (e)：注人pMOS和nMOS的源/漏区

![image-20230502133132473](https://gitee.com/ephtiny/image/raw/master/img/202305021331598.png)

- (a)：沿栅边缘的氮化硅(Si,N?)侧墙(spsoer)起到了掩模作用，由它定义了较深的扩散区城
- (b)：硅化后生成的结构
- (c)：利用CMP步骤使电介质平坦化

​	纳米工艺还涉及另一个称为环形掺杂(halo doping)的步骤，它能提高沟道两端附近的衬底或 阱的掺杂浓度。halo掺杂叮以减轻D[BL、短沟效应和穿通(punchthrough),但会增加CIDL以及在 扩散区与沟道之间pn结的BTBT(带至带隧穿)泄漏

### 3.2.8 接触与金属化

​	接触孔(contact cut)是在源、漏和栅上根据用来形成接触的掩模制造的（源/漏步骤之后刻蚀）

​	金属化(metallization)是形成导线连接器件的工艺。传统的金属化采用铝。可以用蒸铝(evaporation)或溅射(sputtering)法来淀积铝。可以用湿法刻蚀或干法刻蚀除去不希望有的金属。

![](https://gitee.com/ephtiny/image/raw/master/img/202305021447315.png)

​	然后进行后续的金属层之间的通孔(via)和金属化工艺、

​	在扩散区上方的多晶硅通常形成晶体管的栅极，因此需要用金属1的短导线将扩散区的输出节点连接到多晶硅的输人节点。某些工艺在多晶硅上方和金属1下方增加一层钨(W)层，这一层称为局部互连(local interconnect)层，它能设计得比金属1的节距还细。采用局部互连可以实现密度更高的单元版图，尤其是在静态RAM的设计中

### 3.2.9 钝化

​	最后一步工艺是增加一层称为钝化(pasivation)或覆盖玻璃(overglass)的保护玻璃层以防止污染物侵入。钝化层上的开口也称为覆盖玻璃开孔(averglass cut),通过它可以连至I/O焊盘以及所需的探针测试点。在完成钝化之后就可以进行后续步骤，如形成焊凸(bumping),利用这一 焊盘开口中的镀金焊料凸块可以将芯片直接连接到电路板上。

### 3.2.10 测量学

​	光学显微镜可以用来观察尺寸较大的结构和缺陷，但已不适于观察小于可见光波长(约0.5 μm) 的结构。可以用扫描电子显微镜(Scanning Electron Microscopy,SEM)来观察非常小的特征结构。

​	SEM光栅扫描需要观察的结构并观察二次电子发射从而产生该结构表面的图像。能量散射 X射线光谱分析法(Energy Dispersive Spectroscopy,EDX)用电子轰击电路从而引起X射线发射。 这同样可以用来成像。透射电子显微镜( Transmission Electron Microscope,TEM)通过使电子穿过 一个样品(而不是使它们从样品反射回)来观察结果，它也常用来测量结构。

## 3.3 版图设计规则

​	设计规则代表了在性能和成品率之间的一种折中。规则 越保守，所构建电路将正确工作的可能性就越大。但设计规则越宽松，那么改进电路性能和尺寸的机会就越多。

版图设计规则分为：设计规则基础知识、划片槽及其他结构、MOSIS可缩放的CMOS设计规则、微米设计规则

​	设计规则基础知识：阱规则、晶体管规则、接触的规则、金属规则、通孔规则、其他规则

## 3.4 CMOS工艺增强技术

增强技术可以从以下几个方面入手：晶体管、互连、电路元件、超常规CMOS结构

​	晶体管：多阈值电压与栅氧厚度、绝缘体上的硅、高k栅介质、高迁移率、塑料晶体管、高压晶体管

​	互连：大马士革铜工艺、低k介质

​	电路元件：电客、电阻、电感、传输线、双极型晶体管、嵌入式DRAM、非挥发性存储器、熔丝和反熔丝、微电子机械系统(MEMS)、集成光子器件、三维集成电路

## 3.5 与工艺相关的CAD问题

​	为了保证对芯片的描述能转变成实 际可工作的芯片，必须完成两个基本的检查：遵守所规定的几何设计规则、各层掩模间的相互关系在经过制造过程后应能产生正确互连的一组电路元件

​	检查的CAD工具：**设计规则检查**(Design Rule Check,DRC)程序和**掩模的电路提取**(extraction)程序

## 3.6 有关制造的问题

可制造性设计(Design for Manufacturability,DFM)规则：天线规则、层密度规则、分辨率增强规则、金属窄槽规则、成品率改善准则

## 3.7 常见隐患与误区

- 采用最新工艺
- 对商用设计采用x设计规则
- 没有考虑金属填充结构的寄生效应
- 没有包括工艺校准的测试结构
- 撒开设计规则

# 4. 延时

## 4.1 引言

### 4.1.1  定义

- 传播延时(propagation delay time),t~pd~表示从输入越过50%输出越过50%间的最长时间；
- 污染延时(contamination delay tiroe),t~cd~表示从输人越过50%输出越过50%间的最短时间；
- 上升时间(rise time),t~r~表示一个波形从它稳定值的20%升至80%需要的时间；
- 下降时间(fall time),t~f~表示一个波形从它稳定值的80%降至20%需要的时间；
- 边沿速率(edge rate),t~rf~=(t~r~+t~f~)/2。

### 4.1.2 时序优化

有一些路径限制系统工作速度，因而需要关注时序细节的关键路径(critical path)。关键路径可以在以下四个级别的层次上受到影响：

- 结构/微结构级
- 逻辑级
- 电路级
- 版图级

## 4.2 瞬态响应

​	计算延时最基本的方法是建立起所关注电路的物理模型，写出描述输出电压和输入电压及时间关系的微分方程，然后解出这些方程。这些微分方程的解称为瞬态响应( transient response)，而延时就是当输出达到V~DD~/2时所需要的时间。

## 4.3 RC延时模型

​	RC延时模型采用在逻辑门翻转区间上的平均电阻和电容来近似非线性晶体管的I-V和C-V 特性。可以用这个模型估计延时

### 4.3.1 等效电阻

​	晶体管看成是一个开关和一个电阻相串联。等效电阻(effective resistance)就 是在所关心的翻转时间间隔内V~ds~与L~ds~之比的平均值。

​	一个k倍单位宽度的nMOS晶体管具有R/k的电阻，因为它能提供k倍大的电流。一个单位pMOS晶体管具有较大的电阻，一般在2R~3R的范围内，这是由于它有较低的迁移率（R一般在10kΩ的数量级上）

​	根据长沟道模型，电流随沟道长度增加而线性减少，因此它的电阻正比于L。但如果晶体管完全速度饱和，那么电流和电阻将变为与沟道长度无关。

​	相串联的两个晶体管的总电阻是每个晶体管电阻的和，实际的晶体管工作在这两种极端情形之间。这也意味着相串联晶体管的电阻比各个晶体管电阻的和稍低些，这是因为串联晶体管所见到的V~ds~较小因而速度饱和程度也较弱。nMOS管的这一效应比pMOS管更显著(前者具有较高的迁移率和较高程度的速度饱和)

### 4.3.2 栅电容和扩散电容

​	每个晶体管也具有栅电容和扩散电容。我们定义C为一个单位nMOS管或pMOS管的栅电 容。一个k倍单位宽度的晶体管具有kC的电容。扩散电容取决于源/谓区的尺寸。

​	较宽的晶体管将按比例具有较大的扩散电容。增加沟道长度将按比例加大栅电容但不会影响扩散电容。

### 4.3.3 等效RC电路

![image-20230502155312037](https://gitee.com/ephtiny/image/raw/master/img/202305021553149.png)

​	由于空穴的迁移率比电子低，因此pMOS管具有大约两倍于nMOS管的电阻

![image-20230502162012500](https://gitee.com/ephtiny/image/raw/master/img/202305021620585.png)

### 4.3.4 瞬态响应

![image-20230502162043124](https://gitee.com/ephtiny/image/raw/master/img/202305021620200.png)

​	图4.8一个很好的反相器模型，它的尺寸设计成具有相同的上升和下降延时。该系统的传输函数为：

![image-20230502162239304](https://gitee.com/ephtiny/image/raw/master/img/202305021622371.png)

阶跃响应为：

![image-20230502162317333](https://gitee.com/ephtiny/image/raw/master/img/202305021623384.png)

​	传播延时为V~out~达到V~DD~/2时的时间

![image-20230502162420134](https://gitee.com/ephtiny/image/raw/master/img/202305021624192.png)



![image-20230502162450013](https://gitee.com/ephtiny/image/raw/master/img/202305021624068.png)

​	R~1~和R~2~可以模拟一个与非门中两个串联的nMOS晶体管或模拟一个反相器驱动一条电阻不可忽略的长线。它的传输函数为：

![image-20230502162522660](https://gitee.com/ephtiny/image/raw/master/img/202305021625718.png)

这一函数具有两个实数极点，因而它的阶跃响应为：

![image-20230502162552767](https://gitee.com/ephtiny/image/raw/master/img/202305021625836.png)

![image-20230502162610957](https://gitee.com/ephtiny/image/raw/master/img/202305021626025.png)

上式可近似为（当其中一个时间常数明显大于另一个时，效果就会非常好）：

![image-20230502162647640](https://gitee.com/ephtiny/image/raw/master/img/202305021626697.png)

​	如果 R~1~=R~2~=R及C~1~=C~2~=C,那么$\tau$~1~=2.6RC,$\tau$~2~=0.4RC,$\tau$=3RC,此时的二阶响应和它的一阶近似

![image-20230502163017344](https://gitee.com/ephtiny/image/raw/master/img/202305021630409.png)

​	由一阶近似估计的传播延时的误差小于7%甚至在最坏情形下，当两个时 间常数相等时，这个误差也小于15%。但用单个时间常数描述中间节点的行为会很糟糕。

### 4.3.5 Elmore延时

​	大多数电路都可以表示成一个RC树(RC tree),即一个没有闭合回路的RC电路。这一树结构的根就是电压源，而叶子就是在各条支路末端的电容。

​	Elmore延时模型把从信号源发生翻转到其中一个叶子节点发生变化之闻的延时估计为将在每个节点i上的电容C~i~乘以从信号源至该节点i及该叶子节点间公共路径的等效电阻R~is~的积全部相加所得到的和（对于Elmore延时的理解多看例题）。

![image-20230502163301034](https://gitee.com/ephtiny/image/raw/master/img/202305021633098.png)



​	将延时表示成与工艺无关的形式常常很有好处

​	一个扇出为1且无寄生电容的理想反相器的延时为=3RC。 我们在表示归一化延时d时就是相对于这一反相器的延时：

![image-20230502163529094](https://gitee.com/ephtiny/image/raw/master/img/202305021635151.png)

​	扇出为h的反相器的延时，当假设它的扩散电容近似等于它的栅电容时，就可以写成归一 化的形式d=h+1。于是一个FO4(扇出为4)的反相器延时为5$\tau$。如果扩散电容稍大或稍小，那 么FO4延时将改变一个很小的数量。因此从一种工艺到另一种工艺时，用FO4延时度量的电路延时几乎不变。

​	延时包括两个组成部分：**寄生延时**(paraaitic delay)和**努力延时**(effort delay)。寄生延时是一个门驱动它自己内部扩散电容所需要的时间。加大晶体管的宽度将减小电阻但会增大电容，因此寄生延时在理想上与门的尺寸无关。努力延时取决于外部负载电容与输人电容的比h,因而它随晶体管的宽度而变。它也取决于门的复杂程度。这一电容比称为扇出或电气努力 (electrical effort),而代表门复杂度的项称为逻辑努力(logical effort)。

​	例如，反相器延时为d=h+1,所 以它的寄生延时为1而逻辑努力也为1。三输人与非门(NAND3)在最坏情形下的延时为d=(5/3)h +5,所以它的寄生延时为5而逻辑努力为5/3。

### 4.3.6 版图设计对扩散电容大小的影响

​	在一个良好的版图设计中，凡是有可能的地方都要共享扩散节点以减少扩散电容，而且在串 联晶体管之间不带接触的扩散节点通常比必须带接触的扩散节点尺于小。这些不带接触的节点具有较小的电容在手工计算时忽略差别

​	**通过将宽晶体管折叠(folding)也可以减少扩散电容**

![image-20230502164119623](https://gitee.com/ephtiny/image/raw/master/img/202305021641699.png)

- (a)为一个24/12λ反相器的常规 版图。由于一个单位(4λ)晶体管的扩散电容为C,所以该反相器的总扩散电容为9C。
- (b)所示的折叠版图中，每个晶体管由两 个一半宽度的器件并联构成。可以看到扩散区面 积被缩小了两倍，因而使扩散电容减少到4.5C。

### *4.3.7 确定等效电阻

​	如果晶 体管已达到了充分的速度饱和，即V~dsat~<V~DD~/2，那么晶体管将在整个跳变过程中一直保持在饱和区因而电流大致保持在I~dsat~不变。在这种情形下，等效电阻为：

![image-20230502164503187](https://gitee.com/ephtiny/image/raw/master/img/202305021645271.png)

​	但在实际的晶体管中，沟长调制和DIBL效应会使电流随V~ds~的减小而稍有减少，从而使等效电阻略有增加。

![image-20230502164550624](https://gitee.com/ephtiny/image/raw/master/img/202305021645700.png)

​	假设输人和输出的斜率相同并且当输入通过V~DD~/2时输出才开始下 降，那么当输入达到V~DD~时输出将达到V~DD~/2

​	定义跳变开始(即当V~gs~=V~DD~/2,V~ds~=V~DD~)时的晶体管电流为I~L~而跳变结束(即当V~gs~= V~DD~,V~ds~=V~DD~/2)时的晶体管电流为I~H~

那么晶体管在翻转事件期间可以近似成 一个电流源I~eff~,它是上述两种极端情形下晶体管电流的平均值：

![image-20230502164947015](https://gitee.com/ephtiny/image/raw/master/img/202305021649079.png)

输出放电至V~DD~/2所需的时间为：

![image-20230502165009092](https://gitee.com/ephtiny/image/raw/master/img/202305021650150.png)

使上式与t~pd~=RC相等得到：

![image-20230502165034934](https://gitee.com/ephtiny/image/raw/master/img/202305021650991.png)

## 4.4 线性延时模型

​	RC延时模型表明延时是逻辑门扇出的线性函数。

一个门的归一化延时可以以$\tau$为单位表示成：**d=f+p**

p是这个门未连负载时本身固有的寄生延时，f是努力延时，也称为单级努力(stage effort), 它取决于这个门的复杂程度和扇出：f=gb

门的复杂度由逻辑努力(logical effort)g来表示。反相器的逻辑努力定义为1。 较复杂的门具有较大的逻辑努力，这表明它们在驱动一个给定的扇出时需要较长的时间。

当一个门驱动h个与它完全相同的门时，我们就说它的扇出或电气努力(elecctrical effort)为h。当负载不含与驱动器完全相同的逻辑门时，电气努 力可以按下式计算：$h = \frac{C_{out}}{C_{in}}$。C~out~为被驱动的外部负载电容，而C~in~为驱动门的输人电容。

![image-20230502165717577](https://gitee.com/ephtiny/image/raw/master/img/202305021657657.png)

​	图4.21同时画出了一个理想反相器和三输人与非门的归 一化延时与电气努力的关系。y截距表示寄生延时，即逻辑门没有驱动任何负载时的延时。两条直线的斜率为各自的逻辑努力。根据定义反相器的斜率为1,而三输人与非门的斜率为5/3。

### 4.4.1 逻辑势（也译为逻辑努力）

![image-20230502165818132](https://gitee.com/ephtiny/image/raw/master/img/202305021658197.png)

![](https://gitee.com/ephtiny/image/raw/master/img/202305021658925.png)

### 4.4.2 寄生延时

![image-20230502165852736](https://gitee.com/ephtiny/image/raw/master/img/202305021658806.png)

![image-20230502165915147](https://gitee.com/ephtiny/image/raw/master/img/202305021659214.png)

​	图4.23显示了一个有n个输入的与非门模型，其中上面的输入信号都为1,而最下 面的一个输人信号上升。这个门除了使输出端上的电容放电以外，还必须使所有内部节点上的 扩散电容放电。它的Elmore延时为：

![image-20230502165940096](https://gitee.com/ephtiny/image/raw/master/img/202305021659159.png)

### 4.4.3 逻辑门的延时

### 4.4.4 驱动强度

​	在一个良好的标准单元库中，每种常见的门可以有多种不同的尺寸。这些尺寸一般都以它们的驱动强度标注。

​	通常比较直观的是用门的驱动强度即倍数x

如果我们把一个单位反相器重新定义为具有一个单位的输入电容，那么任何一个门的驱动强度为：$x=\frac{C_{in}}{g}$

此时延时可以用驱动强度表示为：$d=\frac{C_{out}}{x}+p$

### *4.4.5 从数据表中提取逻辑努力

![image-20230502171841444](https://gitee.com/ephtiny/image/raw/master/img/202305021718572.png)

### *4.4.6 线性延时模型的局限性

​	线性延时模型局限性存在于：输入与输出斜率、输入到达时间、速度饱和、电压的影响、栅-源电客、自举

## 4.5 路径逻辑势

​	逻辑努力方法提供了一种简单的手工计算方法可以为一个功能选择最佳的电路拓扑和逻辑级数。

​	逻辑努力方法也存在一些局限性，还可以采用迭代方法求解尺寸

## *4.6 用于时序分析的延时模型

用于时序分析的延时模型有：基于斜率的线性模型、线性延时模型、电流源模型

​	它们比SPICE模拟要快得多，但又比简单的线性延时模型更精确。这些模型是在网站www,opensourceliberty.org上已形成文档的Liberty标准的一部分

## 4.7 常见隐患与误区

- 给没有带负载的门定义门延时
- 试图通过加大路径中晶体管的尺寸来提高速度
- 试图采用尽可能少的逻辑级来提高速度



# 9. 组合电路设计

## 9.1 引言

数字逻辑分为：组合电路、时序电路

- 组合电路：输出仅取决于它当前的输入；构成组合电路的基本模块是逻辑门
- 时序电路：具有存储元件；构成时序电路的基本模块是寄存器和锁存器

​	绝大多数电路 都采用静态CMOS,因为它鲁棒性好、速度快、能量效率高并易于设计。但某些电路由于对速度、 功耗或电路密度有特别严格的限制而不得不采用其他实现方式。这些其他可选用的CMOS逻辑 形式常称为电路系列(circuit family)

最常用的可选电路系列：**有比电路**、**动态电路**及**传输管电路**

​	**静态CMOS电路的一个缺点**是它的==每个输入端上同时要求有nMOS管和pMOS管==。在输出下 降跳变期间，pMOS管不但无助于下拉电流反而增添了相当大的电容，因此静态CMOS具有较大的逻辑努力

​	静态CMOS逻辑因它的鲁棒性好而尤其受到欢迎。只要逻辑设计和制造过程不出错，那么对于给定的正确输人，它最终总能产生正确的输出。其他电路系列易受许多机理的影响

​	绝缘体上硅(SOI)的芯片消除了导电村底。它们可以达到较小的寄生电容和较大的亚阔值斜 率，这使它们具有较低的功耗和/或较快的速度，但它们也有自己特有的缺点

​	工作在亚阈值区域的静态CMOS门能 使每操作的能量减少一个数量级，但其代价是将损失几个数量级的性能

## 9.2 电路系列

​	有互补nMOS下拉网络和pMOS上拉网络的静态CMOS电路 有良好的噪声容限、足够快、功耗低、对器件扰动不镦感、易于设计、得到CAD工其的广泛支持，以及能很容易地在标准单元库中获得等优点

### 9.2.1 静态CMOS

​	在实现复杂功能时采用组合门特别有利，因为它们具有较小的逻辑努力。

​	当已知一个逻辑门的某一输入最迟达到时，可以以有利于这个输入的方式对该逻辑门进行优化。类似地，当已知一个信号的上升沿或下降沿比较关键时，也可以对该逻辑门进行优化以有利于那个边沿。

#### 9.2.1.1 推气泡(Bubble Pushing)

​	CMOS门在本质上是反相位的，因此与和或的功能必须通过与非门和或非门来实现。

德摩根(DeMorgan)定理可以帮助实现这一变换：

![image-20230516153019169](https://gitee.com/ephtiny/image/raw/master/img/202305161530319.png)

![image-20230516153156225](https://gitee.com/ephtiny/image/raw/master/img/202305161531347.png)

​	一个==与非门等效于反相位输入的或==，一个==或非门等效于反相位输入的与==。同样的关系也适于具有多个输人的门。

​	这些表示方式之间的互换称为**推气泡**

![image-20230516153249509](https://gitee.com/ephtiny/image/raw/master/img/202305161532600.png)

#### 9.2.1.2 复合门

![image-20230516153336619](https://gitee.com/ephtiny/image/raw/master/img/202305161533683.png)

​	函数F=AB+CD可以用一个“与-或-反相-22”(即AOI22)复合门及一个反相器来计算

![image-20230516153418904](https://gitee.com/ephtiny/image/raw/master/img/202305161534997.png)

​	图9.4 显示了如何估算AOI21、AOI22及更复杂的AOI复合门的逻辑努力

​	这些复合门的晶体管宽度都选择成使它们具有与一个单位反 相器相同的驱动能力。每个输入端的逻辑努力是那个输入端的输 入电容与反相器输人电容的比

​	对于AOI21门来说，这意味着它 的OR终端(C)的逻辑努力比它的两个AND终端(A、B)的逻辑努力略小。寄生延时是通过计算 在输出节点上的总扩散电容而粗略估算出来的，即通过把连接到输出端的晶体管的尺寸相加来进行估算。

#### 9.2.1.3 输入顺序对延时的影响

​	逻辑门**不同输入端**的**逻辑努力**和**寄生延时**常常各**不相同**。如与非门和或非门，它们在名义上是对称的，但实际上其不同输人端的逻辑努力和寄生延时仍稍有不同。

![image-20230516153802452](https://gitee.com/ephtiny/image/raw/master/img/202305161538525.png)

​	图9.6显示了一个两输入与非门并标注了它的两个扩散电容。、

​	定义**外层输入**(outer input)为**靠近电源轨线的输入**(例如B)而**内层输入**(inner input)为**靠近输出端的输入**(例如A)。当内层输人最后翻转时寄生延时最小，因为中间节点早已放电。因此，如果已知一个信号比其他信号迟到达，那么当这个信号连接到内层输人端时逻 辑门的速度最快。

​	内层输入端的逻辑努力稍大些，但这一效应对设计者的意义不大，因为合理设计的电路，在它所应用的扇出范围内总是保持内层输人的速度较快。

#### 9.2.1.4 不对称门

​	当一个输入远不如另一个输入关键时，即使在名义上对称的门也可以使它不对称而有利于改善迟到输入信号的性能，其代价是牺牲早到输入信号的性能。

- 在串联网络中，这需要把早到的输人信号连接到外层晶体管上并使该晶体管较宽，这样当关键输入信号到达时，它就能提供较小的串联电阻。
- 在并联网络中，早到的输入信号应连接到较窄的晶体管上以减少寄生电容。

![image-20230516154653499](https://gitee.com/ephtiny/image/raw/master/img/202305161546575.png)

​	在通常情况下该路径的作用是作为在A和Y之间的缓冲器。

​	改善输入A的逻辑努力的代价是复位输人端的逻辑努力将变得很大

​	在复位输入端上pMOS晶体管的尺寸减小 将减小它的扩散电容和寄生延时，其代价是使复位响应变慢。



​	CMOS晶体管通常都出现速度饱和现象，因此串联晶体管中的电流比长沟道模型所预测的电流大。

​	对于不对称门，等效宽度就是内层(较窄)晶体管的宽度，而等效长度正比于串联晶体管相 对宽度的倒数之和。相对电流可用下式计算，其中N为等效长度。

![image-20230516155231014](https://gitee.com/ephtiny/image/raw/master/img/202305161552095.png)

![image-20230516155320831](https://gitee.com/ephtiny/image/raw/master/img/202305161553903.png)

​	图9.8显示了如何构造一个对称的与非门。

#### 9.2.1.5 偏斜门(skewed gate)

​	优化上升输出跳变的高偏斜(Hl-skew)门和优化下降输出跳变的低偏斜(LO-skew)门，这些优化可通过减小非关键晶体管的尺寸来实现

​	**上升(上拉)和下降(下拉) 跳变的逻辑努力分别称为g.和ga,并且它们就是偏斜门的输入电容与一个对相应跳变具有相同 驱动能力的不偏斜反相器的输人电容之比**

![image-20230516155439569](https://gitee.com/ephtiny/image/raw/master/img/202305161554672.png)

- (a)中，通过减小nMOS管的尺寸来构造一个高偏斜反相器。它对关键跳变来说仍将保持相同的等效电阻
- (b)中，不偏斜反相器来说它的输入电容减少了，因而使那个关键跳变的逻辑努力减小到g~u~=2.5/3=5/6。这一优化是以非关键跳变的逻辑努力为代价的
- (c)中得到了下拉努力为g~d~=2.5/1.5=5/3

​	**偏斜的程度**(如==快速跳变时的等效电阻相对于慢速跳变时的等效电阻的比==)将影响逻辑努力和噪声容限，这一**比值通常为2**

​	在原理图中我们常常在偏斜门的符号上标记一个H或L

​	当只有一个跳变很重要时，可以采用另外一类高偏斜和低偏斜门

#### 9.2.1.6 P/N比

![image-20230516160333735](https://gitee.com/ephtiny/image/raw/master/img/202305161603821.png)

​	在不偏斜门中的pMOS管尺寸很大，目的是为了使上升延时与下降延时相同。它们虽然只为帮助改善上升延时，却同时对两个方向的跳变都增加了输人电容。

​	==逻辑门最优的P/N比(即pMOS管宽度与nMOS管宽度的比)：使平均延时最小的这一比值等于使上升和下降延时相等时的P/N比值的平方根==

![image-20230516160345972](https://gitee.com/ephtiny/image/raw/master/img/202305161603056.png)

​	一个单元库的P/N比应当根据面积、功耗和可靠性而不是根据平均延时来选择。大多数标准单元库中，单元间的 节距决定了在任何具体门中所能实现的P/N比，其中反相器常用的比值为1.5~2。

#### 9.2.1.7 多阈值电压

​	具有较低阙值电压的晶体管能提供较大的导通电流，但在关断时也具有接指数关系增长的较大的泄漏电流。

​	低阈值门可以适度用来减少关键路径的延时。偏斜门只在关键的晶体管网络上才采用低阅值器件。

### 9.2.2 有比电路

​	==有比电路的正确工作取决于器件是否选择了合适的尺寸或电阻==

![image-20230516160638605](https://gitee.com/ephtiny/image/raw/master/img/202305161744247.png)

​	从原理上讲，有比逻辑门是由一个nMOS的下拉网络及称为静态负载(static load)的某种上拉器件构成。

​	静态负载应当足够弱，使输出能被下拉至一个可接受的0电平。因此，在静态负裁和下拉网络之间有一个比值约束。==**较强的静态负载**将使**上升输出较快**，但却**增大了V~OL~**,**减少了噪声容限**，并在输出应当为0时产生**较大的静态功耗**。==不同于互补CMOS电路，**有比电路的这一比值必须正确选择**

​	耗尽型(depletion mode)晶体管与通常的增强型(enhancement mode)晶体管没有什么不同，只是通过**额外的离子注入**建立起**负的阙值电压**。**耗尽型上拉管总是处于弱导通状态**

#### 9.2.2.1 伪nMOS

![image-20230516161242613](https://gitee.com/ephtiny/image/raw/master/img/202305161612705.png)

- (a)为一个伪nMOS(pseudo-nMOS)反相器。在大多数CMOS工艺中，作为静态负载的是栅极接地的单个pMOS管，因此这个pMOS管总是处于导通状态
- (b)和(c)就是180nm工艺下的伪nMOS反相器的直流(DC)传输特性。β比值将影响传输特性的形状和反相器的V~OL~。pMOS晶体管尺寸相对较大时将使上升时间较快但会使传输特性较不陡峭
- (d)显示了当nMOS晶体管导通时，将有一个静态直流电流流过该电路。

![image-20230516161516633](https://gitee.com/ephtiny/image/raw/master/img/202305161615717.png)

​	为了在噪声容限和速度之间进行折中选择，pMOS管的 宽度选择成使它的驱动强度为nMOS下拉网络的1/4左右(即等效宽度为下拉网络的1/2),这一最优尺寸取决于工艺，但通常在1/3～1/6的范围内。

​	**为了计算伪nMOS门的逻辑努力，可以假设一个互补CMOS单位反相器在上升和下降跳变中都传送大小为1的电流**。对于图中所示的晶体管宽度，pMOS将产生I/3的电流而nMOS网络将 产生4I/3的电流。每种跳变的逻辑努力可以计算为它的输入电容与在相应跳变时具有相同电流 的互补CMOS反相器的输人电容之比。对于下降跳变，pMOS管实际上将与nMOS下拉网络竞争。 此时输出电流可以估算为下拉电流减去上拉电流，即(4I/3-I/3)=I,因此可以将每个门与单位 反相器进行比较来计算g~d~。例如，伪nMOS反相器下降跳变时的逻辑努力就是它的输人电容(4/3)与一个单位互补CMOS反相器的输人电容(3)之比，即4/9。而g~u~是g~d~的三倍大，因为上拉电流只有下拉时输出电流的1/3。

​	**寄生延时也可以通过计算输出电容并将它与具有相同电流的一个反相器比较而求得**。例如，伪nMOS或非门具有10/3个单位扩散电容而单位尺寸互补CMOS反相器具有3个单位扩散电容， 因此它下拉时的寄生延时为10/9。由于上拉电流只有1/3大，所以上拉时的寄生延时为10/3。

​	对于与非门结构，平均来说伪nMOS比静态CMOS慢，但伪nMOS用来构成或非结构时性能较好

​	**在伪nMOS宽或非门(即输入数月很多的或非门)中逻辑努力与输人数目无关**



​	**当伪nMOS门的V~OL~大于接收门的V~IL~时，它将不能正确工作**。这最有可能发生在**SF设计角**处，因为此时nMOS晶体管较弱而pMOS晶体管较强。为使设计能在SF角处有可接受的噪声容限，我们不得不在正常角处保守地选择较弱的pMOS管。

![image-20230516162236740](https://gitee.com/ephtiny/image/raw/master/img/202305161622823.png)

​	可以采用偏置电路来降低对工艺的敏感程度，如图9.17所示。**偏置电路的目的是建立起一个偏置电压Vw,使P2管传送的电流是N2管电流的1/3而与pMOS和nMOS管迁移率的相对大小无关**。N2管的宽度为3/2,因此在导通时产生3I/2的电流。N1管的连接方式使它总是导通，它的作用像是一个电流源，其电流为N2管电流的1/3，即I/2。PL的作用是一个电流镜，它通过反馈建立起足够的偏置电压以提供与N2管 相等的电流即I/2。

​	**当A为低时，伪 nMOS门被I/2的电流上拉，而当A为高时，伪nMOS门被(3l/2-I/2)=1的有效电流下拉**。这一偏置技术将严格按照晶体管的宽度来设置相对电流，而与pMOS和nMOS迁移率的相对大小无关（一阶近似）。

​	这一复制偏置技术**允许电流比为1/3**而不是在前述电路中比较保守的电流比1/4,从而**减小了逻辑努力**。偏置电压V~bias~可以分布到多个伪nMOS门中。

​	这一技术仍然具有一定的工艺敏感性。这一偏置是相对于V~DD~的，所以无论在偏置电压线上或在V~DD~电源轨线上的任何噪声都将影响电路性能。

![image-20230516162624519](https://gitee.com/ephtiny/image/raw/master/img/202305161626590.png)

​	当该逻辑闲置时或在IDDQ测试模式期间通过关断pMOS晶体管可以降低功耗

#### 9.2.2.2 共输出CMOS

![image-20230516162704070](https://gitee.com/ephtiny/image/raw/master/img/202305161627156.png)

​	图9.19显示了输出端连在一起的一对CMOS反相器。

![image-20230516162818440](https://gitee.com/ephtiny/image/raw/master/img/202305161628521.png)

​	表9.1为它的真值表，它表明这一对 反相器计算或非函数。

​	这样的电路常常称为对称或非门(symmetric NOR),或更一 般地称为共输出CMOS(ganged CMOS)门

- 当一个输人为0而另一个输入为1时，该 门在满足正确尺寸比的约束条件下可以看成一个伪nMOS电路。
- 当两个输入都为0时，两个 pMOS管并联导通，此时将输出上拉至高电平的速度要比它们在通常的伪nMOS门中更快。
- 当两个输人都为1时，两个pMOS管都变为截止，因而没有静态功耗。

​	这一对称或非门比起一个两输入的伪nMOS或非门来能同时实现较高的性能和较低的功耗。

### 9.2.3 串联电压开关逻辑

​	串联电压开关逻辑(Cascode Voltage Switch Logic),即CVSL 接收一组互补的输入信号并利用一对nMOS下拉网络同时计算出两个互补的输出

![image-20230516172826070](https://gitee.com/ephtiny/image/raw/master/img/202305161728144.png)

- (a)中，下拉网络f实现像在静态CMOS门中那样的逻辑函数，而f将反相位的输入送至按“互补导通”规则(conduction complement)布置的晶体管上。**对于任何给定的输人图案，其中一个下拉网络将导通而另一个将关断**。导通的下拉网络将使它的输出拉低。 这一低电平输出使另一侧的pMOS管导通，从而将另一侧的输出拉高。当另一侧的输出上升时， 又使这一侧的pMOS管截止，所以**不会发生任何静态功耗**
- (b)中显示了一个CVSL的与/与非门。在一个网络中并联的晶体管在另一个网络中有它们相应的串联组合
- (c)为一个4输入的异或门。图中**两个下拉网络共享晶体管A和$\overline{A}$，使晶体管的数目减少了两个**。复杂函数中常常有可能共享晶体管，并且已有系统化的方法可用来设计共享晶体管的网络

​	**CVSL具有潜在的速度优势**，因为**所有的逻辑都由nMOS管实现**因而**减少了输人电容**。CVSL中**pMOS管的尺寸非常重要**。

- **尺寸大的pMOS管将减慢下降跳变**。但不同于伪nMOS,CVSL中的反馈作用将会关断pMOS管，所以输出 最终将稳定到一个正确的逻辑电平上。
- **尺寸小的pMOS管会使互补输出在被拉高时变慢**。

​	另外CVSL门也增加了延时与功耗。还有一方面CVSL还需要有一个与之相互补的、 晶体管堆叠很高因而速度很慢的与非结构，因此CVSL不适于用来实现通常的与非和或非逻辑。总而言之，CVSL最有用的是它的设想。

### 9.2.4 动态电路

​	有比电路采用一个电阻性的上拉器件代替连在输人端上的多个pMOS管，从而减少了输人电容，但有比电路的缺点包括上升跳变较慢、下降眺变时的竞争、静态功耗及V~OL~不为零等。动态电 路采用时钟控制的上拉晶体管而不是总是导通的pMOS管，从而克服了这些缺点

![image-20230516192917182](https://gitee.com/ephtiny/image/raw/master/img/202305161929262.png)

- 在预充(电)(prechrge)模式，时钟φ为0,因而钟控pMOS管导通使输出端Y初始化至高电平
- 在求值(evaluation)模式，时钟φ为1因而钟控pMOS管截止，此时输出端可能保持在高电平或可能通过下拉网络放电至低电平

​	==动态电路是最快的常用电路系列，因 为它们具有较低的输人电容并且在翻转期间不出现任何竞争。它们的静态功耗也为零。但它们需要仔细设计时钟，有较大的动态功耗并且在求值期间对噪声很敏感==

![image-20230516175515423](https://gitee.com/ephtiny/image/raw/master/img/202305161755485.png)

​	(c)中，如果在预充期间输入A为1,那么就将发生竞争，因为此时pMOS管和 nMOS管将同时导通。为此当输人不能保证在预充期间为0时，可以将⋯个额外的钟控求值晶体 管增加到nMOS堆叠组合的底部以避免竞争，如图9.23所示。这一额外的晶体管常称为足管 (foot)。图9.24显示了一个一般化的有足(footed)和无足(unfooted)动态门。

![image-20230516193024795](https://gitee.com/ephtiny/image/raw/master/img/202305161930868.png)

![image-20230516193035643](https://gitee.com/ephtiny/image/raw/master/img/202305161930712.png)

​		由于预充发生在动态门闲置(等待输入)期间并且常常进行得很慢，所以**预充管的宽度**可以选择为**具有两倍的单位电阻**。这将**减少时钟的电容负载和寄生电容**，其代价是使**上升延时加大**。

​	**足管的尺寸**可以比其他nMOS管**大**些，以**减少其他输人端的逻辑努力**，其代价是**加大了时钟的负载**

​	**动态门的逻辑努力很小**。有足动态门的逻辑努力比与它们 相应的无足动态门大，但仍然比静态逻辑好

​	动态门的逻辑努力不取决于输人的数目，因此特别适于实现宽或非功能或多路开关。自然寄生延时将随输入数目的增多而增加，因为此时在输出节点上有较多的扩散电容。



​	动态电路一个最基本的难点是它要求输入的单调性(monotonicity),即**动态门在求值时输入必须单调上升**(monotonically rsing),即输入可以在起始时为低电平并保持在低电平，可以在起始 时为低电平并上升至高电平，或在起始时为高电平并保持在高电平，但不能从起始时的高电平下 降至低电平。

![image-20230516194104993](https://gitee.com/ephtiny/image/raw/master/img/202305161941068.png)

​	动态门的输出在起始时为高电平而在求值期间单调下降至低电平。这一单调 下降的输出X不适合作为第二个动态门的输 入，因为后者希望的是单调上升的输入信号

​	由于单调性问题，**共享同一时钟的动态门不能直接连接**，共享同一时钟且直接连接的动态门用多米诺逻辑解决

# 附录 硬件描述语言