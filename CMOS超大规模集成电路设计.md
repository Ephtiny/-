# 1. 引论

## 1.1 集成电路简史

晶体管(Transistor)发展历程：点接触式晶体管 -> 双极型晶体管 -> 半导体场效应管(MOSFET)

晶体管：

- 一个电阻或半导体器件，当电信号从它的输入端通过它传输到输出端时会被放大
- 可以看成一个电控开关，有一个控制端和另外两个端口，取决于加在控制端上的电压或电流，这两个端口将连通或断开。1

双极型晶体管：

- 需要将一个小电流输入到控制端（基极）以通断另外两个端口（发射极和集电极）之间大得多的电流
- 基极电流在电路不翻转时仍然存在，由它们引起的静态功耗限制了最多能集成在单个管芯上的晶体管数目
- 相对较可靠、噪声低，且功率效率高

半导体场效应(MOSFET)：

- 有两种类型：nMOS和pMOS，分别采用n型硅和p型硅
- 闲置状态下的控制电流几乎为零



互补金属氧化物半导体，即CMOS：首批MOSFET逻辑门，同时采用nMOS和pMOS晶体管。电路采用分离器件晶体管，但功耗只有几纳瓦，相对双极型电路，功耗减低了六个数量级



摩尔定律：单芯片上的晶体管数目没18个月就会翻一倍

尺寸缩小定律：晶体管尺寸缩小时，它们将变得更快，功耗更小，且制造成本更低



芯片的集成度分为小规模、中规模、大规模和超大规模

- 小规模集成(Small-Scale Integration, SSI)电路如7404反相器，含10个以下的逻辑门，每个门大约由6个晶体管组成
- 中规模集成(Medium-Scale Integration, MSI)电路如74161计数器，含多至1000个门
- 大规模集成(Large-Scale Integration, LSI)电路如简单的8位微处理器，含至多10 000个门
- 超大规模(Very Large-Scale Integration, VLSI)电路用于描述自20世纪80年代以来的大多数集成电路



​	虽然单个CMOS晶体管每次开关时只需消耗很少的能量，但巨大数目的晶体管以非常高的速率开关时所产生的功耗再次称为设计的主要考虑因素。而且当晶体管的尺寸变得很小时，它们就不能完全关断。因而虽然经过每个晶体管的泄露电流很小，但当一块芯片上有上亿个晶体管时将会导致非常大的功耗



CMOS制造工艺的特征尺寸：可靠生产处的晶体管的最小尺寸

​	制造商每两三年就开发处特征尺寸再缩小30%的新一代工艺（也称为工艺节点），使再相同的芯片面积上能集成多两倍数目的晶体管

​	微米工艺中较不显著的效应，如晶体管的泄露电流、相邻晶体管之间的特性扰动以及导线电阻等在纳米工艺中将变得非常显著

​	每个晶体管的光刻成本在下降，但一次就能成功的设计成本却一直呈指数规律增长



## 1.2 概述

​	随着单芯片上晶体管数目的急剧增长，设计者已开始依靠不断提高自动化水平来寻求获取相应的生产效率。许多设计者把他们的主要精力放在用硬件描述语言描述功能而很少去注意实际的晶体管。但芯片设计不是软件工程。解决较困难的问题需要对电路和物理设计有基本的理解

​	学习VLSI设计的最好方法就是亲自实践，`www.cmosvlsi.com`网站上提供了一组实验训练以指导你设计自己的微处理芯片



## 1.3 MOS晶体管

​	硅是大多数集成电路的基础原材料。纯净的硅由三维的原子晶格(lattice)组成。纯净的硅是一种不良导体，但它的导电性可以通过在硅晶格中引入称为掺杂剂(dopant)的少量杂质来提高

​	砷(As)掺杂（V族元素）,室温下的晶格热振动可以使砷的第五个价电子自由运动，形成一个带整点的As^+^离子和一个自由电子，该自由电子可以携带电流，从而提高了材料的导电性。这类半导体的自由载流子是==带负电荷的电子==，所以称之为==n型半导体==

​	硼(B)掺杂（III族元素），它可以从相邻的硅原子中借一个电子，使这个硅原子因此缺少一个电子，而这个硅原子又向相邻的硅原子借电子，以此类推会出现”空穴“在晶格中传播。空穴的作用像一个==带正电荷的载流子==，所以称这类半导体为==p型半导体==



二极管：p型和n型硅之间形成的结

- 当作阳极的p型半导体上的电压高于作阴极的n型半导体时，二极管正向偏置，有电流流过。反之则反向偏置，几乎无电流

 金属-氧化物-半导体(MOS)结构是通过把几层到点和绝缘材料叠在一起形成类似三明治的结构而构成的

CMOS工艺提供两种类型的晶体管，它们也称为器件(device)：n型晶体管(nMOS)和p型晶体管(pMOS)

![image-20230421213617184](https://gitee.com/ephtiny/image/raw/master/img/202304212136891.png)

图1.9中n^+^和p^+^区域表好中掺杂的n型或p型硅

​	晶体管的工作是由电场控制的，所以这些器件又称为金属氧化物半导体场效应晶体管(MOSFET)

​	每个晶体管由一层导电栅(gate)、一层二氧化硅绝缘层以及一层硅基底（也称衬底、体、体硅）堆叠构成，这一叠层结构杯称为金属-氧化物-半导体或MOS（早起栅由金属形成，现在用多晶硅）。

​	在同时有这两种类型晶体管的CMOS工艺中，衬底可以使n型的，也可以是p型的，但类型与衬底上晶体管不同的另一种晶体管必须构造在专门的阱(well)中，阱中加入了掺杂院子以形成相反类型的衬底

​	源和漏是完全一样的，可以互换。栅是一个控制输入：它影响电流在源和漏之间的流动

- 对于nMOS管。其衬底一般接地，而源和漏雨衬底之间的p-n结都是反向偏置的。如果栅也接地，那么不会有电流流过反偏结，于是称此时晶体管关断。如果提高栅电压，会建立一个电场将自由电子吸引到Si-SiO~2~的界面下，栅压足够高时电子数目将超过空穴，栅下方称为”沟道“(channel)的一层区域将反型称为n型半导体，源和漏之间形成通路，此时晶体管导通
- 对于pMOS管则相反。其衬底保持在正电压。pMOS管的行为与nMOS管相反，其符号在栅极上有个小圆圈，就如逻辑门中反相器符号图上的小圆圈

![image-20230421220529532](https://gitee.com/ephtiny/image/raw/master/img/202304212205607.png)

图1.10中g、s和d分别表示栅、源和漏



## 1.4 CMOS逻辑

### 1.4.1 反相器

![image-20230421220707493](https://gitee.com/ephtiny/image/raw/master/img/202304212207572.png)

CMOS反相器（即非(NOT)门）由一个nMOS管和一个pMOS管构成。当输入A为0时，n关断而p导通，Y连至V~DD~，即输出Y为1。

![image-20230421221117543](https://gitee.com/ephtiny/image/raw/master/img/202304212211615.png)



### 1.4.2 与非(NAND)门

![image-20230421221305213](https://gitee.com/ephtiny/image/raw/master/img/202304212213289.png)

![image-20230421221834043](https://gitee.com/ephtiny/image/raw/master/img/202304212218140.png)

k输入的与非门由k个串联的nMOS管和k个并联的pMOS管构成，只有三个输入均为1时，输出才会通过串联的nMOS管下拉至低电平



### 1.4.3 CMOS逻辑门

​	反相器和与非门是静态CMOS逻辑门(static CMOS logic gate)也称互补CMOS门(complementary CMOS gate)的两个例子

![image-20230421222847334](https://gitee.com/ephtiny/image/raw/master/img/202304212228412.png)

​	静态CMOS门中的这两个网络被设计成对于任何一种输入图案，其中必有一个网络导通，而另一个关断。当没有这个设计时会有如下的输出状态表

![image-20230421224126489](https://gitee.com/ephtiny/image/raw/master/img/202304212241561.png)

- Z：当上拉和下拉都关断时会形成高阻(high impedance)，即浮空(floating)的输出状态Z。这在多路开关、存储单元及三态总线驱动器中很有意义
- X：当上拉而和下拉同事导通时就形成竞争(contention)电平，急用叉号(crowbar)表示的电平X。此时这连个网络之间的竞争将产生一个不确定的输出电平并引起静态功耗，这是我们不希望出现的情况



​	反相器中的上拉和下拉网络每个都只含一个晶体管，与非门采用一个晶体管串联的下拉网络和一个晶体管斌两的上拉网络

​	两个或多个晶体管的串联组合只有当所有串联的晶体管都导通时才导通，两个或多个晶体管的并联组合只要其中任何一个并联的晶体管导通就能导通。下面是一对nMOS管和pMOS管串并联时的情形，利用这些结构的组合可以构造出许多种CMOS组合门

![image-20230421223907720](https://gitee.com/ephtiny/image/raw/master/img/202304212239812.png)



### 1.4.4 或非(NOR)门

![image-20230421224644605](https://gitee.com/ephtiny/image/raw/master/img/202304212246691.png)

​	对于三输入或非门，当任何一个输入为高时，输出通过并联的nMOS管下拉至低电平。当所有输入为低时，输出通过串联的pMOS管上拉至高电平



### 1.4.5 复合门(compound gate)

![image-20230421225543323](https://gitee.com/ephtiny/image/raw/master/img/202304212255417.png)



​	实现一对二输入“与”的“或非”功能 常被称为与-或-非-22或AOI22。

​	图1.18中的a、b相对容易理解，“与”的表达式可以通过串联实现。接下来将“或”拆分为两部分，一个为a中两组一组导通则下拉，因此a中两组并联且置于下方，也就是nMOS下拉网络

​	对于pMOS上拉网络，我们必须计算与nMOS网络互补的表达式，它所采用的开关管在极性相反的输入时导通。根据德摩根定理，这相当于将一个网络中的“与”（“或”）操作与另一个网络中的“或”（“与”）操作互换。因此与下拉网络中串联nMOS管相对应的上拉网络中的pMOS管必须并联，而与下拉网络中并联nMOS管相对应的上拉网络中的pMOS管必须串联。

​	上面是书本原话，下面是我对这个的理解（这里的理解可能会存在问题，如果能看懂原文的意思那下面就不用看了）：

- 对表达式与图的分析：由于b是下拉网络，则d是上拉网络。通过表达式可知，需要(A·B)与(C·D)都要为0才能上拉（pMOS管是输入为0时导通），即A与B、C与D这两组都至少有一个是0，AB并联可以实现AB间有一个0就可导通，CD并联一样，之后二者串联
- 对原文的理解：根据我的观察，我发现nMOS负责下拉，pMOS负责上拉。对于pMOS上拉网络，计算nMOS网络互补的表达式则下拉网络中串联的变并联，并联的变串联。pMOS上拉网络所采用的开关管在极性相反的输入时导通，这里的极性相反应该不是指输入的数值相反，而应该是最终效果相反。

​	

​	当使$$C=\overline{A}$$并作为选择信号时，这个AOI22门可以用来作为一个二输入的反相多路开关，即若C=0时，Y=$$\overline{B}$$，而C为1时，Y=$$\overline{D}$$



![image-20230421235645374](https://gitee.com/ephtiny/image/raw/master/img/202304212356445.png)

​		图1.19为 或-与-非-3-1（即OAI31）门。当D为1且ABC中任何一个为1时，nMOS下拉网络将时输出下拉为低电平，所以D和A、B及C的并联组合串联在一起。由于pMOS上拉网络是nMOS下拉网络的“互补导通”，所以在pMOS上拉网络中D必须和A、B及C的串联组合并联



### 1.4.6 传输管(Pass Transistor)和传输门(Transmission Gate)

​	一个信号的强度(strength)是以它与理想电压源的接近程度来度量的。一般来说，信号越强它所能提供或吸收的电流就越多。	

​	电源电压V~DD~和GND各为最强的1和0信号源，又称轨线(rail)电压

![image-20230422151015984](https://gitee.com/ephtiny/image/raw/master/img/202304221510065.png)

​	nMOS管在传送0时是一个近乎理想的开关，因此说能传送“强0”；而传送1时不理想，得到的高电压比V~DD~要低些。pMOS管则相反。输入驱动下拉网络中nMOS只需传送0，而互补上拉网络中pMOS只需传送1，输出总是被强驱动，因而输出电平永远不会变弱，这样的门被称为“全复原”(full restored)逻辑门，能大大简化电路设计

![image-20230422151810719](https://gitee.com/ephtiny/image/raw/master/img/202304221518822.png)

- 传输管：nMOS或pMOS单独作用作为一个非理想开关
- 传输门/传送门：将nMOS与pMOS并联、

​	在图1.21(c)中，无论0还是1都能被这个开关以一种可以接受的方式传送出去

​	静态CMOS门总能正确工作而与晶体管的实际尺寸无关，且对于任何输入组合，“1”和“0”之间不会有通过晶体管使它们直接导通的路径，这也是CMOS中静态功耗很低的主要原因

​	不能直接将反相器的上下拉管互换来构成非反相门，这样会产生减弱的输出

![image-20230422153408295](https://gitee.com/ephtiny/image/raw/master/img/202304221534406.png)

​	复合门也可以也可以用两个与门、一个或门和一个反相器构成，而与门和或门又可以用与非/或非门及反相器构成，但这里总共需要20个晶体管

![image-20230422153637483](https://gitee.com/ephtiny/image/raw/master/img/202304221536559.png)

### 1.4.7 三态门

![image-20230422153821179](https://gitee.com/ephtiny/image/raw/master/img/202304221538250.png)

​	当EN为1时，三态缓冲器的作用就像一个普通的缓冲器

​	图1.26的传输门与图1.25的三态缓冲期真值表相同

![image-20230422154228860](https://gitee.com/ephtiny/image/raw/master/img/202304221542929.png)

​	EN为0时，输出浮空；EN为1时可当作反相器

​	d是三态反相器的符号。一个普通反相器之后接一个三态反相器可以构成一个三态缓冲器

​	三态总线会存在一些问题，现在设计者优先采用多路开关

### 1.4.8 多路开关(Multiplexer)



### 1.4.9 时序电路(Sequential Circuit)

#### 1.4.9.1 锁存器(Latch)

#### 1.4.9.2 触发器(Flip-Flop)

## 1.5 CMOS的制造和版图

### 1.5.1 反相器的横截面图

### 1.5.2 制造工艺

### 1.5.3 版图设计规则

### 1.5.4 门级版图

### 1.5.5 棒图

## 1.6 设计划分(Design Partitioning)

### 1.6.1 设计抽象(Design Abstraction)

### 1.6.2 结构化设计

### 1.6.3 行为、结构和物理设计域

## 1.7 举例：一个简单的MIPS微处理器

### 1.7.1 MIP体系结构

### 1.7.2 多周期MIPS微结构

## 1.8 逻辑设计

### 1.8.1 顶层接口

### 1.8.2 方块图

### 1.8.3 设计层次

### 1.8.4 硬件描述语言

## 1.9 电路设计

## 1.10 物理设计

### 1.10.1 平面规划

### 1.10.2 标准单元

### 1.10.3 节距匹配

### 1.10.4 分片规划

### 1.10.5 阵列

### 1.10.6 面积估算

## 1.11 设计验证

## 1.12 制造、封装和测试